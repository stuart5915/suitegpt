<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Governance | SUITE Docs</title>
    <link rel="icon" type="image/png" href="/assets/suite-logo-new.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/suite-styles.css">
    <link rel="stylesheet" href="/nav.css">
    <link rel="stylesheet" href="/docs/docs.css">
</head>
<body>
    <nav id="main-nav"></nav>
    <script src="/nav-component.js"></script>
    <div class="canvas-container">
        <div class="docs-container">
            <aside class="docs-sidebar"></aside>
            <script src="/docs/sidebar.js"></script>
            <main class="docs-content">
                <h1>Governance</h1>
                <p class="subtitle">Shape SUITE's future with Rep and quadratic voting.</p>

                <div class="info-box">
                    <h4>The Rep System</h4>
                    <p style="margin-bottom: 0;"><strong>Rep (Reputation)</strong> is your voting power in SUITE. It's non-transferable, earned through participation, and spent to amplify your voice on proposals.</p>
                </div>

                <h2>What is Rep?</h2>
                <p>Rep is SUITE's governance currency. Unlike token-based voting where whales dominate, Rep rewards active participation:</p>
                <ul>
                    <li><strong>Non-transferable</strong> ‚Äî You can't buy or sell Rep</li>
                    <li><strong>Earned through action</strong> ‚Äî Deposit, vote, contribute</li>
                    <li><strong>Spent to vote</strong> ‚Äî More votes = more Rep cost (quadratic)</li>
                </ul>

                <h2>How to Earn Rep</h2>

                <div class="earn-grid">
                    <div class="earn-card">
                        <div class="icon">üí∞</div>
                        <div class="title">Treasury Deposit</div>
                        <div class="desc">Deposit USDC to the vault and earn Rep proportional to your contribution.</div>
                        <div class="reward">+1 Rep per $1 deposited</div>
                    </div>
                    <div class="earn-card">
                        <div class="icon">üìà</div>
                        <div class="title">Yield Earned</div>
                        <div class="desc">When the vault generates yield, LP holders receive Rep based on their share.</div>
                        <div class="reward">+1 Rep per $1 yield</div>
                    </div>
                    <div class="earn-card">
                        <div class="icon">‚úÖ</div>
                        <div class="title">Proposal Passed</div>
                        <div class="desc">Submit a proposal that the community approves and implements.</div>
                        <div class="reward">+50 Rep + total Rep voted</div>
                    </div>
                    <div class="earn-card">
                        <div class="icon">üó≥Ô∏è</div>
                        <div class="title">First Vote</div>
                        <div class="desc">Cast your first vote on any proposal to get a participation bonus.</div>
                        <div class="reward">+1 Rep (one-time)</div>
                    </div>
                </div>

                <h2>Quadratic Voting</h2>
                <p>SUITE uses <strong>quadratic voting</strong> to prevent whale dominance. The more votes you cast on a single proposal, the more Rep each additional vote costs:</p>

                <div class="power-example">
                    <h4>Vote Cost Calculator</h4>
                    <div class="calc">
1st vote = <span class="highlight">FREE</span>
2nd vote = 1 Rep  (1 total)
3rd vote = 2 Rep  (3 total)
4th vote = 3 Rep  (6 total)
5th vote = 4 Rep  (10 total)

<span class="highlight">Formula: cost(n) = n √ó (n-1) / 2</span>
                    </div>
                </div>

                <p>This means someone with 100 Rep can't just dominate every vote ‚Äî they have to choose which proposals matter most to them.</p>

                <h2>Proposal Types</h2>

                <div class="vote-types">
                    <div class="vote-type">
                        <div class="icon">‚ö°</div>
                        <div class="title">Feature</div>
                        <div class="desc">New functionality for existing apps like FoodVitals, OpticRep, TrueForm, etc.</div>
                    </div>
                    <div class="vote-type">
                        <div class="icon">üêõ</div>
                        <div class="title">Bug Fix</div>
                        <div class="desc">Report and prioritize bugs that need fixing across the platform.</div>
                    </div>
                    <div class="vote-type">
                        <div class="icon">üí°</div>
                        <div class="title">App Idea</div>
                        <div class="desc">Propose entirely new apps for the AI Fleet to build.</div>
                    </div>
                    <div class="vote-type">
                        <div class="icon">üîß</div>
                        <div class="title">Improvement</div>
                        <div class="desc">Enhancements to existing features, UX improvements, optimizations.</div>
                    </div>
                </div>

                <h2>Proposal Lifecycle</h2>

                <div class="gov-card">
                    <h4>1. Submitted</h4>
                    <p>Anyone with a connected account can submit a proposal. Describe what you want built or changed. AI helps generate titles and categories if you don't specify.</p>
                </div>

                <div class="gov-card">
                    <h4>2. Open Voting</h4>
                    <p>When the first vote is cast, a <strong>7-day voting period</strong> begins. Community members spend Rep to vote for or against. Discuss in the comments.</p>
                </div>

                <div class="gov-card">
                    <h4>3. Resolution</h4>
                    <p>After voting ends, proposals are reviewed. Passed proposals enter the AI Fleet's build queue. Authors of passed proposals earn bonus Rep.</p>
                </div>

                <div class="fleet-diagram">
                    <div class="diagram-title">PROPOSAL FLOW</div>
                    <div class="flow-container">
                        <div class="flow-box">
                            <div class="flow-icon">üìù</div>
                            <div class="flow-label">Submitted</div>
                        </div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="flow-box highlight">
                            <div class="flow-icon">üó≥Ô∏è</div>
                            <div class="flow-label">Voting</div>
                            <div class="flow-sublabel">7 days</div>
                        </div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="flow-box green">
                            <div class="flow-icon">üî®</div>
                            <div class="flow-label">Building</div>
                        </div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="flow-box purple">
                            <div class="flow-icon">üöÄ</div>
                            <div class="flow-label">Shipped</div>
                        </div>
                    </div>
                </div>

                <h2>Discussion & Comments</h2>
                <p>Every proposal has a comments section where the community can:</p>
                <ul>
                    <li>Ask clarifying questions about the proposal</li>
                    <li>Suggest improvements or alternatives</li>
                    <li>Share relevant context or concerns</li>
                    <li>Coordinate support for important changes</li>
                </ul>
                <p>Click the üí¨ button on any proposal to view and add comments.</p>

                <h2>Current Phase: Founder Stewardship</h2>

                <div class="concept-card">
                    <h4>Building the Foundation</h4>
                    <p>SUITE is currently in the <strong>Founder Stewardship</strong> phase. This means:</p>
                    <ul style="margin: 12px 0 0 0; padding-left: 20px;">
                        <li>The founder maintains oversight of final decisions</li>
                        <li>Community input shapes priorities through voting</li>
                        <li>Governance rules are being refined based on real usage</li>
                        <li>All changes are documented publicly</li>
                    </ul>
                </div>

                <div class="concept-card green">
                    <h4>Future: Council Governance</h4>
                    <p>As the ecosystem matures, governance will transition to the <strong>SUITE Council</strong> ‚Äî holders who permanently lock SUITE tokens into the Treasury. Locked forever = permanent voice in SUITE's direction.</p>
                </div>

                <h2>Voting Rules</h2>
                <ul>
                    <li><strong>One direction per proposal</strong> ‚Äî Once you vote FOR or AGAINST, you can't switch</li>
                    <li><strong>Add more votes anytime</strong> ‚Äî You can increase your vote power (costs more Rep)</li>
                    <li><strong>All votes are public</strong> ‚Äî Governance data is fully transparent</li>
                    <li><strong>Spam penalty</strong> ‚Äî Proposals marked as spam cost the author 10 Rep</li>
                </ul>

                <h2>Get Started</h2>
                <ol>
                    <li><a href="/factory.html" style="color: #ff9500; font-weight: 600;">Go to the Factory</a> to view proposals</li>
                    <li>Connect via Telegram or wallet to participate</li>
                    <li>Cast your first vote (it's free!)</li>
                    <li>Earn Rep through deposits and participation</li>
                    <li>Submit your own proposals to shape SUITE's future</li>
                </ol>

                <p style="color: #9ca3af; font-size: 0.85rem; margin-top: 32px;"><em>Last updated: January 2026</em></p>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <!-- ADMIN DASHBOARD (Only visible to admin wallets) -->
                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="adminDashboard" style="display: none; margin-top: 48px;">
                    <h2>Admin Dashboard</h2>

                    <div class="concept-card" style="border: 2px solid rgba(239, 68, 68, 0.3); background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), rgba(220, 38, 38, 0.02));">
                        <!-- Admin Header -->
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #ef4444, #dc2626); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;">üîê</div>
                            <div>
                                <h4 style="margin: 0; font-size: 1rem; font-weight: 800; color: #dc2626;">SUITE Staking Admin</h4>
                                <p style="margin: 0; font-size: 0.8rem; color: #6b7280;">Contract interactions on Base</p>
                            </div>
                            <div id="adminStatus" style="margin-left: auto; background: rgba(107, 114, 128, 0.1); color: #6b7280; padding: 4px 12px; border-radius: 100px; font-size: 0.75rem; font-weight: 700;">
                                ‚óã Not Connected
                            </div>
                        </div>

                        <!-- Contract Addresses -->
                        <div style="background: rgba(0,0,0,0.03); border-radius: 8px; padding: 12px; margin-bottom: 20px; font-family: monospace; font-size: 0.75rem;">
                            <div style="margin-bottom: 6px;"><strong>SuiteToken:</strong> <a href="https://basescan.org/address/0x3CA9C32e99f71cE856647ED489360a1c1297f849" target="_blank" style="color: #3b82f6;">0x3CA9...f849</a></div>
                            <div style="margin-bottom: 6px;"><strong>SuiteStaking:</strong> <a href="https://basescan.org/address/0xA56735aAfc14fc0c3953D6d98AE7c1feea919E0b" target="_blank" style="color: #3b82f6;">0xA567...9E0b</a></div>
                            <div><strong>Network:</strong> Base (Chain ID: 8453)</div>
                        </div>

                        <!-- Staking Functions Grid -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">

                            <!-- Buy SUITE -->
                            <div style="background: rgba(34, 197, 94, 0.05); border: 1px solid rgba(34, 197, 94, 0.2); border-radius: 12px; padding: 16px;">
                                <div style="font-weight: 700; color: #22c55e; font-size: 0.9rem; margin-bottom: 8px;">üíµ Buy SUITE</div>
                                <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 12px;">USDC ‚Üí SUITE to your wallet</div>
                                <div style="display: flex; gap: 8px;">
                                    <input type="number" id="buyAmount" placeholder="USDC amount" style="flex: 1; padding: 10px 14px; border: 1px solid rgba(0,0,0,0.1); border-radius: 8px; font-size: 0.9rem;">
                                    <button onclick="callBuy()" style="padding: 10px 16px; background: #22c55e; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Buy</button>
                                </div>
                                <div style="font-size: 0.7rem; color: #9ca3af; margin-top: 6px;">Rate: 1 USDC = 1000 SUITE</div>
                            </div>

                            <!-- Stake SUITE -->
                            <div style="background: rgba(59, 130, 246, 0.05); border: 1px solid rgba(59, 130, 246, 0.2); border-radius: 12px; padding: 16px;">
                                <div style="font-weight: 700; color: #3b82f6; font-size: 0.9rem; margin-bottom: 8px;">üîí Stake SUITE</div>
                                <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 12px;">Lock SUITE for credits</div>
                                <div style="display: flex; gap: 8px;">
                                    <input type="number" id="stakeAmount" placeholder="SUITE amount" style="flex: 1; padding: 10px 14px; border: 1px solid rgba(0,0,0,0.1); border-radius: 8px; font-size: 0.9rem;">
                                    <button onclick="callStake()" style="padding: 10px 16px; background: #3b82f6; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Stake</button>
                                </div>
                            </div>

                            <!-- Buy & Stake -->
                            <div style="background: rgba(168, 85, 247, 0.05); border: 1px solid rgba(168, 85, 247, 0.2); border-radius: 12px; padding: 16px;">
                                <div style="font-weight: 700; color: #a855f7; font-size: 0.9rem; margin-bottom: 8px;">‚ö° Buy & Stake</div>
                                <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 12px;">USDC ‚Üí SUITE ‚Üí Staked (one tx)</div>
                                <div style="display: flex; gap: 8px;">
                                    <input type="number" id="buyAndStakeAmount" placeholder="USDC amount" style="flex: 1; padding: 10px 14px; border: 1px solid rgba(0,0,0,0.1); border-radius: 8px; font-size: 0.9rem;">
                                    <button onclick="callBuyAndStake()" style="padding: 10px 16px; background: #a855f7; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Buy & Stake</button>
                                </div>
                            </div>

                            <!-- Unstake -->
                            <div style="background: rgba(239, 68, 68, 0.05); border: 1px solid rgba(239, 68, 68, 0.2); border-radius: 12px; padding: 16px;">
                                <div style="font-weight: 700; color: #ef4444; font-size: 0.9rem; margin-bottom: 8px;">üîì Unstake SUITE</div>
                                <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 12px;">Get SUITE back (minus used credits)</div>
                                <div style="display: flex; gap: 8px;">
                                    <input type="number" id="unstakeAmount" placeholder="SUITE amount" style="flex: 1; padding: 10px 14px; border: 1px solid rgba(0,0,0,0.1); border-radius: 8px; font-size: 0.9rem;">
                                    <button onclick="callUnstake()" style="padding: 10px 16px; background: #ef4444; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Unstake</button>
                                </div>
                            </div>
                        </div>

                        <!-- User Stats -->
                        <div style="background: rgba(255,255,255,0.8); border-radius: 12px; padding: 16px;">
                            <div style="font-weight: 700; color: #2d1b4e; font-size: 0.9rem; margin-bottom: 12px;">üìä Your Balances</div>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; text-align: center;">
                                <div>
                                    <div style="font-size: 0.7rem; color: #6b7280;">USDC Balance</div>
                                    <div id="userUsdcBalance" style="font-size: 1rem; font-weight: 700; color: #22c55e;">-</div>
                                </div>
                                <div>
                                    <div style="font-size: 0.7rem; color: #6b7280;">SUITE in Wallet</div>
                                    <div id="userSuiteBalance" style="font-size: 1rem; font-weight: 700; color: #3b82f6;">-</div>
                                </div>
                                <div>
                                    <div style="font-size: 0.7rem; color: #6b7280;">SUITE Staked</div>
                                    <div id="userStakedBalance" style="font-size: 1rem; font-weight: 700; color: #a855f7;">-</div>
                                </div>
                                <div>
                                    <div style="font-size: 0.7rem; color: #6b7280;">Available Credits</div>
                                    <div id="userAvailableCredits" style="font-size: 1rem; font-weight: 700; color: #f59e0b;">-</div>
                                </div>
                            </div>
                            <button onclick="refreshBalances()" style="margin-top: 12px; padding: 8px 16px; background: rgba(0,0,0,0.05); color: #6b7280; border: 1px solid rgba(0,0,0,0.1); border-radius: 8px; font-size: 0.8rem; cursor: pointer; width: 100%;">üîÑ Refresh Balances</button>
                        </div>

                        <!-- Connect Wallet Button -->
                        <button id="connectWalletBtn" onclick="connectWallet()" style="margin-top: 16px; padding: 12px 24px; background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; width: 100%; font-size: 0.95rem;">
                            üîó Connect Wallet
                        </button>

                        <!-- Transaction Status -->
                        <div id="txStatus" style="display: none; margin-top: 12px; padding: 12px; border-radius: 8px; font-size: 0.85rem; text-align: center;"></div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Admin Dashboard Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.9.0/dist/ethers.umd.min.js"></script>
    <script>
        // ============================================
        // ADMIN CONFIGURATION
        // ============================================
        const ADMIN_WALLETS = [
            '0x92D67D8ad8B986e78b369bE0272E121AE5ACAd59'.toLowerCase(),
            '0xDEfc3AE5a990206101463d208E7e1446c58a72bD'.toLowerCase(),
            '0x53cf707eF11cD213D8f1710996C22049a45B8215'.toLowerCase()
        ];

        // Contract addresses on Base
        const SUITE_TOKEN = '0x3CA9C32e99f71cE856647ED489360a1c1297f849';
        const SUITE_STAKING = '0xA56735aAfc14fc0c3953D6d98AE7c1feea919E0b';
        const USDC_BASE = '0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913';
        const BASE_CHAIN_ID = 8453;

        // ABIs
        const STAKING_ABI = [
            'function buy(uint256 usdcAmount) external',
            'function stake(uint256 amount) external',
            'function buyAndStake(uint256 usdcAmount) external',
            'function unstake(uint256 amount) external',
            'function stakedBalance(address) view returns (uint256)',
            'function availableCredits(address) view returns (uint256)',
            'function suitePerUsdc() view returns (uint256)'
        ];

        const ERC20_ABI = [
            'function balanceOf(address) view returns (uint256)',
            'function approve(address spender, uint256 amount) returns (bool)',
            'function allowance(address owner, address spender) view returns (uint256)',
            'function decimals() view returns (uint8)'
        ];

        let provider = null;
        let signer = null;
        let walletAddress = null;

        // Check if wallet is admin
        function isAdminWallet(address) {
            if (!address) return false;
            return ADMIN_WALLETS.includes(address.toLowerCase());
        }

        // Show/hide admin dashboard
        function updateAdminVisibility() {
            const dashboard = document.getElementById('adminDashboard');
            const status = document.getElementById('adminStatus');
            const connectBtn = document.getElementById('connectWalletBtn');

            if (walletAddress && isAdminWallet(walletAddress)) {
                dashboard.style.display = 'block';
                status.innerHTML = '‚óè Admin Active';
                status.style.background = 'rgba(34, 197, 94, 0.1)';
                status.style.color = '#22c55e';
                connectBtn.innerHTML = `‚úì ${walletAddress.slice(0,6)}...${walletAddress.slice(-4)}`;
                connectBtn.style.background = 'rgba(34, 197, 94, 0.1)';
                connectBtn.style.color = '#22c55e';
                refreshBalances();
            } else if (walletAddress) {
                dashboard.style.display = 'none';
            } else {
                // Show dashboard but disconnected for admins to see connect button
                // Actually hide it until connected
                dashboard.style.display = 'none';
            }
        }

        // Connect wallet
        async function connectWallet() {
            try {
                if (!window.ethereum) {
                    alert('Please install MetaMask!');
                    return;
                }

                provider = new ethers.BrowserProvider(window.ethereum);

                // Request accounts
                const accounts = await provider.send('eth_requestAccounts', []);
                walletAddress = accounts[0];

                // Check network
                const network = await provider.getNetwork();
                if (Number(network.chainId) !== BASE_CHAIN_ID) {
                    try {
                        await window.ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: '0x2105' }]
                        });
                    } catch (e) {
                        await window.ethereum.request({
                            method: 'wallet_addEthereumChain',
                            params: [{
                                chainId: '0x2105',
                                chainName: 'Base',
                                nativeCurrency: { name: 'ETH', symbol: 'ETH', decimals: 18 },
                                rpcUrls: ['https://mainnet.base.org'],
                                blockExplorerUrls: ['https://basescan.org']
                            }]
                        });
                    }
                    provider = new ethers.BrowserProvider(window.ethereum);
                }

                signer = await provider.getSigner();
                updateAdminVisibility();

            } catch (err) {
                console.error('Connect error:', err);
                showTxStatus('Failed to connect: ' + err.message, 'error');
            }
        }

        // Refresh balances
        async function refreshBalances() {
            if (!walletAddress || !provider) return;

            try {
                const usdc = new ethers.Contract(USDC_BASE, ERC20_ABI, provider);
                const suite = new ethers.Contract(SUITE_TOKEN, ERC20_ABI, provider);
                const staking = new ethers.Contract(SUITE_STAKING, STAKING_ABI, provider);

                const [usdcBal, suiteBal, stakedBal, credits] = await Promise.all([
                    usdc.balanceOf(walletAddress),
                    suite.balanceOf(walletAddress),
                    staking.stakedBalance(walletAddress),
                    staking.availableCredits(walletAddress)
                ]);

                document.getElementById('userUsdcBalance').textContent = (Number(usdcBal) / 1e6).toFixed(2);
                document.getElementById('userSuiteBalance').textContent = (Number(suiteBal) / 1e18).toLocaleString();
                document.getElementById('userStakedBalance').textContent = (Number(stakedBal) / 1e18).toLocaleString();
                document.getElementById('userAvailableCredits').textContent = (Number(credits) / 1e18).toLocaleString();
            } catch (err) {
                console.error('Refresh error:', err);
            }
        }

        // Show transaction status
        function showTxStatus(msg, type) {
            const el = document.getElementById('txStatus');
            el.style.display = 'block';
            el.textContent = msg;
            el.style.background = type === 'error' ? 'rgba(239,68,68,0.1)' :
                                  type === 'success' ? 'rgba(34,197,94,0.1)' : 'rgba(59,130,246,0.1)';
            el.style.color = type === 'error' ? '#ef4444' :
                             type === 'success' ? '#22c55e' : '#3b82f6';
        }

        // Buy SUITE
        async function callBuy() {
            const amount = document.getElementById('buyAmount').value;
            if (!amount || !signer) return;

            try {
                showTxStatus('Approving USDC...', 'pending');
                const usdc = new ethers.Contract(USDC_BASE, ERC20_ABI, signer);
                const usdcAmount = BigInt(Math.floor(parseFloat(amount) * 1e6));

                const allowance = await usdc.allowance(walletAddress, SUITE_STAKING);
                if (allowance < usdcAmount) {
                    const approveTx = await usdc.approve(SUITE_STAKING, usdcAmount);
                    await approveTx.wait();
                }

                showTxStatus('Buying SUITE...', 'pending');
                const staking = new ethers.Contract(SUITE_STAKING, STAKING_ABI, signer);
                const tx = await staking.buy(usdcAmount);
                await tx.wait();

                showTxStatus('Success! SUITE sent to wallet.', 'success');
                refreshBalances();
            } catch (err) {
                showTxStatus('Error: ' + err.message, 'error');
            }
        }

        // Stake SUITE
        async function callStake() {
            const amount = document.getElementById('stakeAmount').value;
            if (!amount || !signer) return;

            try {
                showTxStatus('Approving SUITE...', 'pending');
                const suite = new ethers.Contract(SUITE_TOKEN, ERC20_ABI, signer);
                const suiteAmount = ethers.parseEther(amount);

                const allowance = await suite.allowance(walletAddress, SUITE_STAKING);
                if (allowance < suiteAmount) {
                    const approveTx = await suite.approve(SUITE_STAKING, suiteAmount);
                    await approveTx.wait();
                }

                showTxStatus('Staking SUITE...', 'pending');
                const staking = new ethers.Contract(SUITE_STAKING, STAKING_ABI, signer);
                const tx = await staking.stake(suiteAmount);
                await tx.wait();

                showTxStatus('Success! SUITE staked for credits.', 'success');
                refreshBalances();
            } catch (err) {
                showTxStatus('Error: ' + err.message, 'error');
            }
        }

        // Buy and Stake
        async function callBuyAndStake() {
            const amount = document.getElementById('buyAndStakeAmount').value;
            if (!amount || !signer) return;

            try {
                showTxStatus('Approving USDC...', 'pending');
                const usdc = new ethers.Contract(USDC_BASE, ERC20_ABI, signer);
                const usdcAmount = BigInt(Math.floor(parseFloat(amount) * 1e6));

                const allowance = await usdc.allowance(walletAddress, SUITE_STAKING);
                if (allowance < usdcAmount) {
                    const approveTx = await usdc.approve(SUITE_STAKING, usdcAmount);
                    await approveTx.wait();
                }

                showTxStatus('Buying & Staking...', 'pending');
                const staking = new ethers.Contract(SUITE_STAKING, STAKING_ABI, signer);
                const tx = await staking.buyAndStake(usdcAmount);
                await tx.wait();

                showTxStatus('Success! SUITE bought and staked.', 'success');
                refreshBalances();
            } catch (err) {
                showTxStatus('Error: ' + err.message, 'error');
            }
        }

        // Unstake SUITE
        async function callUnstake() {
            const amount = document.getElementById('unstakeAmount').value;
            if (!amount || !signer) return;

            try {
                showTxStatus('Unstaking SUITE...', 'pending');
                const staking = new ethers.Contract(SUITE_STAKING, STAKING_ABI, signer);
                const suiteAmount = ethers.parseEther(amount);
                const tx = await staking.unstake(suiteAmount);
                await tx.wait();

                showTxStatus('Success! SUITE returned to wallet.', 'success');
                refreshBalances();
            } catch (err) {
                showTxStatus('Error: ' + err.message, 'error');
            }
        }

        // Listen for account changes
        if (window.ethereum) {
            window.ethereum.on('accountsChanged', (accounts) => {
                walletAddress = accounts[0] || null;
                updateAdminVisibility();
            });
        }

        // Check on page load if already connected
        window.addEventListener('load', async () => {
            if (window.ethereum) {
                try {
                    provider = new ethers.BrowserProvider(window.ethereum);
                    const accounts = await provider.listAccounts();
                    if (accounts.length > 0) {
                        walletAddress = accounts[0].address;
                        signer = await provider.getSigner();
                        updateAdminVisibility();
                    }
                } catch (e) {
                    console.log('Not connected yet');
                }
            }
        });
    </script>
</body>
</html>
