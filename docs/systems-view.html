<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Systems Architecture | SUITE</title>
    <link rel="icon" type="image/png" href="../assets/suite-mascot.png">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../nav.css">
    <style>
        /* Base styles */
        * {
            box-sizing: border-box;
        }

        /* Fix nav logo image size */
        .nav-logo img {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            object-fit: contain;
        }

        body {
            font-family: 'Nunito', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #fff5eb 0%, #ffe4d4 20%, #ffd4e3 50%, #e8d5f9 80%, #d4e5ff 100%);
            min-height: 100vh;
            color: #2d1b4e;
        }

        /* Canvas Container */
        .canvas-container {
            width: 100%;
            min-height: 100vh;
            padding: 90px 24px 40px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Main docs wrapper */
        .docs-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 32px;
            box-shadow: 0 16px 80px rgba(0, 0, 0, 0.08);
            padding: 30px;
            width: 100%;
            max-width: 1200px;
            display: flex;
            gap: 30px;
        }

        /* Sidebar */
        .docs-sidebar {
            width: 220px;
            flex-shrink: 0;
            border-right: 1px solid rgba(0, 0, 0, 0.06);
            padding-right: 24px;
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-title {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #9ca3af;
            margin-bottom: 12px;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            color: #2d1b4e;
            text-decoration: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.2s;
            margin-bottom: 4px;
        }

        .sidebar-link:hover {
            background: rgba(255, 149, 0, 0.1);
            color: #ff9500;
        }

        .sidebar-link.active {
            background: linear-gradient(135deg, #ff9500, #ff6b9d);
            color: white;
        }

        /* Main content */
        .docs-content {
            flex: 1;
            min-width: 0;
        }

        .system-card {
            background: white;
            border-radius: 20px;
            padding: 32px;
            margin-bottom: 32px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .system-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: #2d1b4e;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .system-desc {
            color: #666;
            margin-bottom: 24px;
            font-size: 1rem;
        }

        /* Side-by-side layout: image left, dropdowns right */
        .system-layout {
            display: flex;
            gap: 24px;
            align-items: flex-start;
        }

        .system-diagram {
            flex: 1;
            min-width: 0;
        }

        .system-details {
            flex: 1;
            min-width: 280px;
        }

        .diagram-img {
            width: 100%;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        /* Stack on mobile */
        @media (max-width: 900px) {
            .system-layout {
                flex-direction: column;
            }
        }

        .expand-section {
            border: 1px solid #eee;
            border-radius: 12px;
            margin-bottom: 12px;
            overflow: hidden;
        }

        .expand-section summary {
            padding: 16px 20px;
            cursor: pointer;
            font-weight: 700;
            color: #2d1b4e;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .expand-section summary:hover {
            background: #f0f0f5;
        }

        .expand-section[open] summary {
            border-bottom: 1px solid #eee;
            background: linear-gradient(135deg, #ff9500, #ff6b9d);
            color: white;
        }

        .expand-content {
            padding: 20px;
            background: white;
            color: #444;
            line-height: 1.7;
        }

        .expand-content code {
            background: #f5f5f5;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .expand-content pre {
            background: #1a1a2e;
            color: #e0e0e0;
            padding: 16px;
            border-radius: 8px;
            font-size: 0.85rem;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-x: hidden;
        }

        .phase-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 100px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-right: 8px;
        }

        .phase-research {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .phase-build {
            background: #dcfce7;
            color: #16a34a;
        }

        .phase-deploy {
            background: #fef3c7;
            color: #d97706;
        }

        .toc {
            background: rgba(255, 149, 0, 0.08);
            border: 2px solid rgba(255, 149, 0, 0.2);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 40px;
        }

        .toc h3 {
            margin: 0 0 16px;
            color: #ff9500;
        }

        .toc-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 8px;
        }

        .toc-list a {
            color: #2d1b4e;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .toc-list a:hover {
            background: rgba(255, 149, 0, 0.1);
            color: #ff9500;
        }
    </style>
</head>

<body>
    <!-- Nav placeholder -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="../index.html" class="nav-logo">
                <img src="../assets/suite-token.png" alt="SUITE">SUITE
            </a>
            <div class="nav-links">
                <a href="../apps.html">Apps</a>
                <a href="../developer-portal.html">Build</a>
                <a href="index.html">Docs</a>
                <a href="../start-building.html" class="nav-cta">üöÄ Start Building</a>
            </div>
        </div>
    </nav>

    <div class="canvas-container">
        <div class="docs-container">
            <!-- Sidebar -->
            <aside class="docs-sidebar"></aside>

            <!-- Main Content -->
            <main class="docs-content">
                <h1 style="font-size: 2.5rem; margin-bottom: 8px;">üèóÔ∏è Systems Architecture</h1>
                <p style="color: #666; font-size: 1.1rem; margin-bottom: 32px;">
                    Bird's-eye view of every system in the SUITE ecosystem. Click any step to see the logic behind it.
                </p>

                <!-- Table of Contents -->
                <div class="toc">
                    <h3>üìã Jump to System</h3>
                    <div class="toc-list">
                        <a href="#ai-fleet">ü§ñ AI Fleet</a>
                        <a href="#watcher-bot">üì° Watcher Bot</a>
                        <a href="#pc-laptop-sync">üîÑ PC-Laptop Sync</a>
                        <a href="#treasury">üí∞ Treasury</a>
                        <a href="#app-store">üè™ App Store</a>
                        <a href="#content-marketplace">üì∏ Content Marketplace</a>
                        <a href="#discord-integration">üí¨ Discord Integration</a>
                        <a href="#auth-system">üîê Authentication</a>
                    </div>
                </div>

                <!-- AI FLEET SYSTEM -->
                <div class="system-card" id="ai-fleet">
                    <h2 class="system-title">ü§ñ AI Fleet</h2>
                    <p class="system-desc">Autonomous app creation system. Creates polished apps 24/7 without human
                        intervention.</p>

                    <div class="system-layout">
                        <div class="system-diagram">
                            <img src="diagrams/ai-fleet.png" alt="AI Fleet System Diagram" class="diagram-img">
                        </div>
                        <div class="system-details">
                            <details class="expand-section">
                                <summary>Human requests? (bugs, features) ‚Üí DO THOSE FIRST</summary>
                                <div class="expand-content">
                                    <p>When a human submits a bug report or feature request, drop everything and handle
                                        it first.</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>Queue empty? ‚Üí PROCEED TO TELOS</summary>
                                <div class="expand-content">
                                    <p>If there are no pending human requests, enter autonomous TELOS mode to build new
                                        apps.</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>Analyze app store trends</summary>
                                <div class="expand-content">
                                    <p>Fetch top 100 apps from Product Hunt, App Store, Play Store. Categorize by
                                        productivity, health, finance, etc.</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>Read user reviews</summary>
                                <div class="expand-content">
                                    <p>Extract common features and pain points from app reviews to understand what users
                                        want.</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>Identify gaps/opportunities</summary>
                                <div class="expand-content">
                                    <p>Find underserved niches with high demand but low supply. Score opportunities by
                                        market size, competition, and feasibility.</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>Generate app concept</summary>
                                <div class="expand-content">
                                    <p>Create app name, tagline, value proposition, target persona, key features, tech
                                        stack, and monetization strategy.</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>Loop: Write code ‚Üí Test ‚Üí Critique ‚Üí Improve</summary>
                                <div class="expand-content">
                                    <p>Build phase with 50 iterations. Each cycle: write code, test it, critique the
                                        result, and improve.</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>Run final tests</summary>
                                <div class="expand-content">
                                    <p>Execute comprehensive test suite to verify everything works before deployment.
                                    </p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>Push to SUITE app store</summary>
                                <div class="expand-content">
                                    <p>Build production bundle with EAS, upload to Expo, and register in suite_apps
                                        table.</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>Log to ai_activity_log</summary>
                                <div class="expand-content">
                                    <p>Record the completed build in the activity log and post announcement to Discord
                                        #new-apps.</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>D) REPEAT ‚Üí Back to Research</summary>
                                <div class="expand-content">
                                    <p>After deployment, cycle back to research to start building the next app.</p>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- WATCHER BOT -->
                <div class="system-card" id="watcher-bot">
                    <h2 class="system-title">üì° Watcher Bot</h2>
                    <p class="system-desc">Processes prompts from Discord/Supabase and injects them into Antigravity IDE
                        windows.</p>

                    <div class="system-layout">
                        <div class="system-diagram">
                            <img src="diagrams/watcher-bot.png" alt="Watcher Bot System Diagram" class="diagram-img">
                        </div>
                        <div class="system-details">
                            <details class="expand-section">
                                <summary>üì• Poll Supabase for prompts</summary>
                                <div class="expand-content">
                                    <pre>
Every 5 seconds:
  SELECT * FROM prompts 
  WHERE status = 'pending' 
  ORDER BY created_at ASC

If found:
  - Set prompt_incoming = True (blocks background clicks)
  - Allocate next available slot (round-robin)
  - Update status to 'processing'</pre>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>‚å®Ô∏è Type prompt into IDE</summary>
                                <div class="expand-content">
                                    <pre>
1. Click at (chat_x, chat_y) to focus input
2. Wait 500ms for focus
3. Prepend PROMPT_PREFIX (anti-browser, anti-question rules)
4. Convert to ASCII-safe text
5. pyautogui.typewrite(text, interval=0.01)
6. Press Enter to send
7. Mark slot_typing[i] = False</pre>
                                    <p><strong>Speed:</strong> ~100 chars/second</p>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>üîÑ Background sync worker</summary>
                                <div class="expand-content">
                                    <pre>
Every 60 seconds (if no slots typing):
  1. Loop through all 3 windows:
     - Click Accept button location
     - Click Retry button location  
     - Press Alt+Enter (for dialogs)
     - Scroll chat to see latest
   
  2. Git sync:
     - git pull --rebase
     - git add -A && git commit
     - git push origin master
     - Write timestamp to .last_push file</pre>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- PC-LAPTOP SYNC -->
                <div class="system-card" id="pc-laptop-sync">
                    <h2 class="system-title">üîÑ PC-Laptop Sync</h2>
                    <p class="system-desc">Bidirectional file sync between your PC and laptop via GitHub.</p>

                    <div class="system-layout">
                        <div class="system-diagram">
                            <img src="diagrams/pc-laptop-sync.png" alt="PC-Laptop Sync System Diagram"
                                class="diagram-img">
                        </div>
                        <div class="system-details">
                            <details class="expand-section">
                                <summary>üì§ PC auto-push (watcher.py)</summary>
                                <div class="expand-content">
                                    <pre>
Every 60 seconds (when no slots typing):
  if git status --porcelain has changes:
    git add -A
    git commit -m "Auto-commit from PC watcher"
    git push origin master
    
    # Write timestamp for UI display
    echo "2026-01-11 03:30:00" > .last_push</pre>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>üì• Laptop pull options</summary>
                                <div class="expand-content">
                                    <p><strong>Option 1: Manual</strong></p>
                                    <pre>Click "Pull Latest from GitHub" button on localhost:3000</pre>

                                    <p><strong>Option 2: Auto-pull loop</strong></p>
                                    <pre>
while ($true) { 
  git pull --rebase 
  Start-Sleep 10 
}</pre>

                                    <p><strong>Option 3: Auto-pull toggle</strong></p>
                                    <pre>Enable in server.py UI - polls Supabase for completed prompts</pre>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- TREASURY & TOKENOMICS -->
                <div class="system-card" id="treasury">
                    <h2 class="system-title">üí∞ Treasury & Tokenomics</h2>
                    <p class="system-desc">$SUITE token economy: floor price guarantee, yield distribution, and giving.
                    </p>

                    <div class="system-layout">
                        <div class="system-diagram">
                            <img src="diagrams/treasury.png" alt="Treasury System Diagram" class="diagram-img">
                        </div>
                        <div class="system-details">
                            <details class="expand-section">
                                <summary>üíé Floor Price Guarantee</summary>
                                <div class="expand-content">
                                    <p>The treasury always backs the token with ETH:</p>
                                    <pre>
FLOOR_PRICE = Treasury ETH Balance / Total $SUITE Supply

Example:
  Treasury: 10 ETH
  Supply: 100,000 SUITE
  Floor: 0.0001 ETH per token

Users can ALWAYS withdraw at floor price.</pre>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>üìà Allocation Strategy</summary>
                                <div class="expand-content">
                                    <p><strong>Under $100k:</strong> 100% reinvested for growth</p>
                                    <p><strong>Over $100k:</strong></p>
                                    <ul>
                                        <li>90% reinvested (yield generation)</li>
                                        <li>10% to Giving Fund (charity votes)</li>
                                    </ul>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- APP STORE -->
                <div class="system-card" id="app-store">
                    <h2 class="system-title">üè™ App Store</h2>
                    <p class="system-desc">Discovery, deployment, and distribution of SUITE apps.</p>

                    <div class="system-layout">
                        <div class="system-diagram">
                            <img src="diagrams/app-store.png" alt="App Store System Diagram" class="diagram-img">
                        </div>
                        <div class="system-details">
                            <details class="expand-section">
                                <summary>üì§ App Submission</summary>
                                <div class="expand-content">
                                    <p>Developers submit via FORGE Discord command:</p>
                                    <pre>
/submit-app {name} {description} {price_in_suite}

Bot creates listing in apps table:
  - Generates preview images
  - Sets status = "pending_review"
  - Notifies reviewers</pre>
                                </div>
                            </details>

                            <details class="expand-section">
                                <summary>üí≥ Revenue Split</summary>
                                <div class="expand-content">
                                    <ul>
                                        <li><strong>70%</strong> ‚Üí Developer</li>
                                        <li><strong>20%</strong> ‚Üí Treasury (platform sustainability)</li>
                                        <li><strong>10%</strong> ‚Üí Giving Fund (charitable causes)</li>
                                    </ul>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- CONTENT MARKETPLACE -->
                <div class="system-card" id="content-marketplace">
                    <h2 class="system-title">üì∏ Content Marketplace</h2>
                    <p class="system-desc">Community-driven content creation. Post bounties, submit work, earn SUITE.
                    </p>

                    <img src="diagrams/content-marketplace.png" alt="Content Marketplace System Diagram"
                        class="diagram-img">

                    <details class="expand-section">
                        <summary>üìã How Bounties Work</summary>
                        <div class="expand-content">
                            <p>Workflow:</p>
                            <pre>
1. Creator posts bounty (e.g. "Need app icon - 50 SUITE")
2. Community submits work
3. Creator approves submission
4. SUITE transferred automatically</pre>
                        </div>
                    </details>

                    <details class="expand-section">
                        <summary>üõí Selling Content</summary>
                        <div class="expand-content">
                            <p>Revenue split for content sales:</p>
                            <ul>
                                <li><strong>80%</strong> ‚Üí Creator</li>
                                <li><strong>15%</strong> ‚Üí Treasury</li>
                                <li><strong>5%</strong> ‚Üí Giving Fund</li>
                            </ul>
                        </div>
                    </details>
                </div>

                <!-- DISCORD INTEGRATION -->
                <div class="system-card" id="discord-integration">
                    <h2 class="system-title">üí¨ FORGE Discord Bot</h2>
                    <p class="system-desc">Queue prompts, manage apps, and get notifications - all from Discord.</p>

                    <img src="diagrams/forge-discord-bot.png" alt="FORGE Discord Bot System Diagram"
                        class="diagram-img">

                    <details class="expand-section">
                        <summary>ü§ñ Bot Commands</summary>
                        <div class="expand-content">
                            <pre>
/addition {prompt}     ‚Üí Queue prompt for AI processing
/create-app {name}     ‚Üí Start new app project  
/delete-app {name}     ‚Üí Remove app from ecosystem
/status                ‚Üí Check watcher/server status
/balance               ‚Üí Check your SUITE balance</pre>
                        </div>
                    </details>

                    <details class="expand-section">
                        <summary>üîî Notifications</summary>
                        <div class="expand-content">
                            <p>FORGE sends DMs for:</p>
                            <ul>
                                <li>‚úÖ Prompt completed (with git commit link)</li>
                                <li>‚ùì AI asked a question (with screenshot)</li>
                                <li>‚ùå Error occurred (with details)</li>
                                <li>üìä Daily summary stats</li>
                            </ul>
                        </div>
                    </details>
                </div>

                <!-- AUTHENTICATION -->
                <div class="system-card" id="auth-system">
                    <h2 class="system-title">üîê SUITE Authentication</h2>
                    <p class="system-desc">Multi-method login with unified user profiles and encrypted data.</p>

                    <img src="diagrams/suite-authentication.png" alt="SUITE Authentication System Diagram"
                        class="diagram-img">

                    <details class="expand-section">
                        <summary>üîë Login Methods</summary>
                        <div class="expand-content">
                            <ul>
                                <li><strong>Discord OAuth:</strong> Primary method for FORGE users</li>
                                <li><strong>Wallet Connect:</strong> MetaMask/WalletConnect for token holders</li>
                                <li><strong>Email:</strong> Supabase magic link for general users</li>
                            </ul>
                            <p>All methods link to a unified user profile.</p>
                        </div>
                    </details>

                    <details class="expand-section">
                        <summary>üë§ User Profile Data</summary>
                        <div class="expand-content">
                            <pre>
{
  "discord_id": "123456789",
  "wallet_address": "0x...",
  "email": "user@example.com",
  "suite_balance": 1500,
  "gov_points": 25,
  "owned_apps": ["FoodVitals", "LifeHub"],
  "role": "contributor"
}</pre>
                        </div>
                    </details>
                </div>

            </main>
        </div>
    </div>

    <script src="sidebar.js"></script>
</body>

</html>