<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Developer Dashboard | SUITE</title>
    <link rel="icon" type="image/png" href="assets/suite-token.png">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="suite-styles.css">
    <link rel="stylesheet" href="nav.css">
    <style>
        /* Critical nav styles inline */
        .nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            padding: 16px 24px;
            background: transparent;
        }

        .nav-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(20px);
            padding: 12px 28px;
            border-radius: 100px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.06);
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 800;
            font-size: 1.4rem;
            color: #2d1b4e;
            text-decoration: none;
        }

        .nav-logo-img {
            width: 36px !important;
            height: 36px !important;
            max-width: 36px !important;
            border-radius: 8px;
            object-fit: contain;
            flex-shrink: 0;
        }

        /* Override global img rule */
        .nav img,
        .nav-inner img,
        .nav-logo img {
            max-width: 36px !important;
            width: 36px !important;
            height: 36px !important;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .nav-links a {
            font-size: 0.95rem;
            font-weight: 600;
            padding: 10px 18px;
            color: #5a4a6f;
            text-decoration: none;
            border-radius: 100px;
        }

        .nav-cta {
            background: linear-gradient(135deg, #ff9500, #ff6b9d) !important;
            color: white !important;
        }

        body {
            background: linear-gradient(135deg, #fff5eb 0%, #ffe4d4 20%, #ffd4e3 50%, #e8d5f9 80%, #d4e5ff 100%);
            min-height: 100vh;
            font-family: 'Nunito', sans-serif;
        }

        /* Canvas wrapper */
        .canvas-container {
            width: 100%;
            min-height: 100vh;
            padding: 90px 24px 40px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            box-sizing: border-box;
        }

        /* Main dashboard wrapper - similar to docs */
        .dashboard-wrapper {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 32px;
            box-shadow: 0 16px 80px rgba(0, 0, 0, 0.08);
            padding: 30px;
            width: 100%;
            max-width: 1300px;
            min-height: 600px;
            margin: 0 auto;
            display: flex;
            gap: 30px;
        }

        /* Sidebar */
        .dashboard-sidebar {
            width: 240px;
            flex-shrink: 0;
            border-right: 1px solid rgba(0, 0, 0, 0.06);
            padding-right: 24px;
        }

        .sidebar-user {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: linear-gradient(135deg, rgba(255, 149, 0, 0.1), rgba(255, 107, 157, 0.1));
            border-radius: 16px;
            margin-bottom: 24px;
        }

        .sidebar-user img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }

        .sidebar-user-info {
            flex: 1;
            min-width: 0;
        }

        .sidebar-user-name {
            font-weight: 700;
            font-size: 0.95rem;
            color: #2d1b4e;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .sidebar-user-logout {
            font-size: 0.75rem;
            color: #ff6b9d;
            cursor: pointer;
            text-decoration: none;
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-title {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #9ca3af;
            margin-bottom: 12px;
            padding-left: 14px;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 14px;
            color: #2d1b4e;
            text-decoration: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.2s;
            margin-bottom: 4px;
            cursor: pointer;
        }

        .sidebar-link:hover {
            background: rgba(255, 149, 0, 0.1);
            color: #ff9500;
        }

        .sidebar-link.active {
            background: linear-gradient(135deg, #ff9500, #ff6b9d);
            color: white;
        }

        .sidebar-link-icon {
            font-size: 1.1rem;
        }

        .sidebar-link-badge {
            margin-left: auto;
            background: rgba(255, 149, 0, 0.2);
            color: #ff9500;
            padding: 2px 8px;
            border-radius: 100px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .sidebar-link.active .sidebar-link-badge {
            background: rgba(255, 255, 255, 0.3);
            color: white;
        }

        /* Main content area */
        .dashboard-main {
            flex: 1;
            min-width: 0;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .dashboard-header h1 {
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ff9500, #ff6b9d);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0;
        }

        /* Section panels (one shown at a time) */
        .section-panel {
            display: none;
        }

        .section-panel.active {
            display: block;
        }

        .panel-header {
            margin-bottom: 24px;
        }

        .panel-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: #2d1b4e;
            margin: 0 0 8px 0;
        }

        .panel-desc {
            color: #6b7280;
            font-size: 0.95rem;
        }

        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255, 149, 0, 0.08), rgba(255, 107, 157, 0.05));
            border-radius: 16px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 900;
            color: #ff9500;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 4px;
        }

        /* Content cards within panels */
        .content-card {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .content-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .content-card h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin: 0;
            color: #2d1b4e;
        }

        /* Login banner */
        .login-banner {
            background: linear-gradient(135deg, #5865F2, #7289da);
            padding: 16px 20px;
            border-radius: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 24px;
        }

        .login-banner-text {
            color: white;
        }

        .login-banner-text strong {
            font-size: 1rem;
        }

        .login-banner-text p {
            margin: 2px 0 0;
            opacity: 0.9;
            font-size: 0.85rem;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .dashboard-wrapper {
                flex-direction: column;
                padding: 20px;
            }

            .dashboard-sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid rgba(0, 0, 0, 0.06);
                padding-right: 0;
                padding-bottom: 20px;
                margin-bottom: 20px;
            }

            .sidebar-section {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                margin-bottom: 12px;
            }

            .sidebar-title {
                width: 100%;
                margin-bottom: 8px;
            }

            .sidebar-link {
                padding: 10px 14px;
                margin-bottom: 0;
            }
        }

        /* Keep old .dashboard-container for backward compat during transition */
        .dashboard-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 120px 20px 40px;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .dashboard-header h1 {
            font-size: 2.2rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ff9500, #ff6b9d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-pill {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 100px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .user-pill img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 24px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 900;
            color: #ff9500;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #666;
            margin-top: 8px;
        }

        .section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            padding: 0;
            margin-bottom: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            overflow: hidden;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 32px;
            cursor: pointer;
            user-select: none;
            transition: background 0.2s;
        }

        .section-header:hover {
            background: rgba(255, 149, 0, 0.05);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 800;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-info {
            flex: 1;
        }

        .section-desc {
            font-size: 0.85rem;
            color: #888;
            font-weight: 400;
            margin-top: 4px;
        }

        .section-toggle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff9500, #ff6b9d);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .section.collapsed .section-toggle {
            transform: rotate(-90deg);
        }

        .section-content {
            padding: 0 32px 32px;
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease, opacity 0.2s ease;
            opacity: 1;
        }

        .section.collapsed .section-content {
            max-height: 0;
            padding: 0 32px;
            opacity: 0;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-weight: 700;
            font-size: 0.9rem;
            color: #444;
        }

        .form-group input,
        .form-group select {
            padding: 14px 18px;
            border: 2px solid #eee;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #ff9500;
            box-shadow: 0 0 0 4px rgba(255, 149, 0, 0.1);
        }

        .toggle-group {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .toggle-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: #ff9500;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff9500, #ff6b9d);
            color: white;
            padding: 16px 32px;
            border: none;
            border-radius: 100px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 30px rgba(255, 149, 0, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(255, 149, 0, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .campaigns-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .campaign-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 16px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .campaign-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .campaign-info img {
            width: 50px;
            height: 50px;
            border-radius: 12px;
        }

        .campaign-stats {
            display: flex;
            gap: 24px;
            font-size: 0.9rem;
        }

        .campaign-stats span {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .campaign-stats strong {
            font-size: 1.1rem;
            color: #ff9500;
        }

        .badge {
            padding: 6px 14px;
            border-radius: 100px;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .badge-active {
            background: #dcfce7;
            color: #16a34a;
        }

        .badge-paused {
            background: #fef3c7;
            color: #d97706;
        }

        .badge-depleted {
            background: #fee2e2;
            color: #dc2626;
        }

        .login-section {
            text-align: center;
            padding: 80px 20px;
        }

        .discord-btn {
            background: #5865F2;
            color: white;
            padding: 16px 32px;
            border: none;
            border-radius: 100px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 12px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #888;
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="index.html" class="nav-logo">
                <img src="assets/suite-token.png" alt="SUITE" class="nav-logo-img">
                SUITE
            </a>
            <div class="nav-links">
                <a href="apps.html">Apps</a>
                <a href="developer-portal.html">Build</a>
                <a href="discuss.html">Discuss</a>
                <a href="incubate.html">Incubate</a>
                <a href="docs/index.html">Docs</a>
                <div class="nav-dropdown">
                    <span class="nav-dropdown-trigger">SUITE</span>
                    <div class="nav-dropdown-menu">
                        <a href="wallet.html">🏦 Vault</a>
                        <a href="dashboard.html">💼 Dashboard</a>
                        <a href="learn.html">📚 Learn</a>
                    </div>
                </div>
                <a href="start-building.html" class="nav-cta">🚀 Start Building</a>
            </div>
            <button class="mobile-menu-btn">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <div class="canvas-container">
        <div class="dashboard-wrapper">
            <!-- Sidebar -->
            <aside class="dashboard-sidebar">
                <!-- User Info (shown when logged in) -->
                <div id="sidebarUser" class="sidebar-user" style="display: none;">
                    <img id="sidebarAvatar" src="assets/suite-mascot.png" alt="">
                    <div class="sidebar-user-info">
                        <div class="sidebar-user-name" id="sidebarUserName">Loading...</div>
                        <a class="sidebar-user-logout" onclick="logout()">Logout</a>
                    </div>
                </div>

                <!-- Login prompt (shown when not logged in) -->
                <div id="sidebarLoginPrompt" class="sidebar-user">
                    <button class="discord-btn" onclick="loginWithDiscord()"
                        style="width: 100%; padding: 12px 16px; font-size: 0.9rem; justify-content: center;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03z" />
                        </svg>
                        Login
                    </button>
                </div>

                <!-- Earn & Spend -->
                <div class="sidebar-section">
                    <div class="sidebar-title">Earn & Spend</div>
                    <div class="sidebar-link" onclick="showSection('earn')">
                        <span class="sidebar-link-icon">💰</span>
                        Earn
                    </div>
                    <div class="sidebar-link" onclick="showSection('store')">
                        <span class="sidebar-link-icon">🛒</span>
                        Store
                    </div>
                </div>

                <!-- Builder Tools -->
                <div class="sidebar-section">
                    <div class="sidebar-title">Builder Tools</div>
                    <div class="sidebar-link active" onclick="showSection('overview')">
                        <span class="sidebar-link-icon">📊</span>
                        Overview
                    </div>
                    <div class="sidebar-link" onclick="showSection('apps')">
                        <span class="sidebar-link-icon">📱</span>
                        Your Apps
                        <span class="sidebar-link-badge" id="appsCount">0</span>
                    </div>
                    <div class="sidebar-link" onclick="showSection('campaigns')">
                        <span class="sidebar-link-icon">📢</span>
                        Campaigns
                    </div>
                    <div class="sidebar-link" onclick="showSection('reviews')">
                        <span class="sidebar-link-icon">⭐</span>
                        Reviews
                    </div>
                    <div class="sidebar-link" onclick="showSection('powerups')">
                        <span class="sidebar-link-icon">⚡</span>
                        Power-Ups
                    </div>
                </div>

                <!-- Content -->
                <div class="sidebar-section">
                    <div class="sidebar-title">Content</div>
                    <div class="sidebar-link" onclick="showSection('studio')">
                        <span class="sidebar-link-icon">🎥</span>
                        Content Studio
                    </div>
                    <div class="sidebar-link" onclick="showSection('marketplace')">
                        <span class="sidebar-link-icon">📸</span>
                        Marketplace
                    </div>
                    <div class="sidebar-link" onclick="showSection('cadence')">
                        <span class="sidebar-link-icon">🎯</span>
                        Cadence
                    </div>
                </div>

                <!-- Community -->
                <div class="sidebar-section">
                    <div class="sidebar-title">Community</div>
                    <div class="sidebar-link" onclick="showSection('suitehub')">
                        <span class="sidebar-link-icon">🏠</span>
                        SUITEHub
                    </div>
                    <div class="sidebar-link" onclick="showSection('giving')">
                        <span class="sidebar-link-icon">💝</span>
                        Giving
                    </div>
                </div>

                <!-- AI Factory (Public - visible to all) -->
                <div class="sidebar-section">
                    <div class="sidebar-title">AI Factory</div>
                    <div class="sidebar-link" onclick="showSection('ai-fleet')">
                        <span class="sidebar-link-icon">🤖</span>
                        AI Fleet
                        <span class="sidebar-link-badge"
                            style="background: rgba(99, 102, 241, 0.2); color: #6366f1;">LIVE</span>
                    </div>
                </div>

                <!-- Admin (Owner Only) -->
                <div class="sidebar-section" id="adminSection" style="display: none;">

                    <div class="sidebar-title">Admin</div>
                    <div class="sidebar-link" onclick="showSection('treasury')">
                        <span class="sidebar-link-icon">🏦</span>
                        Treasury
                    </div>
                    <div class="sidebar-link" onclick="showSection('prompt-server')">
                        <span class="sidebar-link-icon">🖥️</span>
                        PC Prompt Server
                    </div>
                    <div class="sidebar-link" onclick="showSection('lp-incentives')">
                        <span class="sidebar-link-icon">💧</span>
                        LP Incentives
                    </div>
                </div>

            </aside>

            <!-- Main Content -->
            <main class="dashboard-main">
                <!-- Overview Section (default view) -->
                <div id="panel-overview" class="section-panel active">
                    <div class="dashboard-header">
                        <h1>👨‍💻 Developer Dashboard</h1>
                    </div>

                    <!-- Stats -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="totalApps">-</div>
                            <div class="stat-label">Your Apps</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalCampaigns">-</div>
                            <div class="stat-label">Active Campaigns</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalClaims">-</div>
                            <div class="stat-label">Total Claims</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="suiteBalance">-</div>
                            <div class="stat-label">SUITE Balance</div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="content-card">
                        <h3 style="margin-bottom: 16px;">🚀 Quick Actions</h3>
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px;">
                            <button onclick="showSection('apps')" class="btn-primary"
                                style="padding: 14px 20px; font-size: 0.95rem;">
                                📱 Manage Apps
                            </button>
                            <button onclick="showSection('campaigns')" class="btn-primary"
                                style="padding: 14px 20px; font-size: 0.95rem; background: linear-gradient(135deg, #6366f1, #8b5cf6);">
                                📢 Create Campaign
                            </button>
                            <button onclick="showSection('studio')" class="btn-primary"
                                style="padding: 14px 20px; font-size: 0.95rem; background: linear-gradient(135deg, #22c55e, #16a34a);">
                                🎥 Content Studio
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Apps Section -->
                <div id="panel-apps" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">📱 Your Apps</h2>
                        <p class="panel-desc">Apps you've published to the SUITE Store. Manage settings and track
                            performance.</p>
                    </div>
                    <div id="appsList">
                        <div class="empty-state">
                            <p>No apps found. <a href="start-building.html" style="color: #ff9500;">Start building</a>
                                or submit via Discord!</p>
                        </div>
                    </div>
                </div>

                <!-- Treasury Section (Admin) -->
                <div id="panel-treasury" class="section-panel">
                    <div class="section" id="section-treasury" data-section="treasury"
                        style="border: 2px solid rgba(168, 85, 247, 0.3); background: linear-gradient(135deg, rgba(168, 85, 247, 0.05), rgba(99, 102, 241, 0.05));">
                        <div class="section-header" onclick="toggleSection('treasury')">
                            <div class="section-info">
                                <h3 class="section-title">🏦 Treasury Operations</h3>
                                <div class="section-desc">Weekly yield distributions, buffer management, and REP
                                    tracking
                                    (Admin)</div>
                            </div>
                            <div class="section-toggle">▼</div>
                        </div>
                        <div class="section-content">
                            <!-- This Week's Yield -->
                            <div
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                                <div style="background: white; border-radius: 16px; padding: 20px; text-align: center;">
                                    <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 4px;">This Week's
                                        Yield</div>
                                    <div style="font-size: 1.8rem; font-weight: 900; color: #22c55e;">$2,340</div>
                                </div>
                                <div style="background: white; border-radius: 16px; padding: 20px; text-align: center;">
                                    <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 4px;">Liquid Buffer
                                    </div>
                                    <div style="font-size: 1.8rem; font-weight: 900; color: #8b5cf6;">$12,500</div>
                                    <div style="font-size: 0.75rem; color: #22c55e;">✅ 10% (healthy)</div>
                                </div>
                                <div style="background: white; border-radius: 16px; padding: 20px; text-align: center;">
                                    <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 4px;">Total REP Issued
                                    </div>
                                    <div style="font-size: 1.8rem; font-weight: 900; color: #ff9500;">142,500</div>
                                </div>
                            </div>

                            <!-- Pending Distributions -->
                            <h4 style="font-weight: 700; margin-bottom: 12px;">📊 Pending Distributions</h4>
                            <div style="background: #f8f9fa; border-radius: 12px; padding: 16px; margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>🔄 Reinvest to Treasury</span>
                                    <span style="font-weight: 700; color: #22c55e;">$1,800 (77%)</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>💝 Charities</span>
                                    <span style="font-weight: 700; color: #8b5cf6;">$340 (15%)</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>💰 Self-claims</span>
                                    <span style="font-weight: 700; color: #6b7280;">$200 (8%)</span>
                                </div>
                            </div>

                            <!-- Weekly Checklist -->
                            <h4 style="font-weight: 700; margin-bottom: 12px;">📋 Weekly Checklist</h4>
                            <div
                                style="background: rgba(255, 149, 0, 0.1); border-radius: 12px; padding: 16px; margin-bottom: 20px;">
                                <label
                                    style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; cursor: pointer;">
                                    <input type="checkbox" style="width: 20px; height: 20px; accent-color: #ff9500;">
                                    <span>Review pending distributions</span>
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; cursor: pointer;">
                                    <input type="checkbox" style="width: 20px; height: 20px; accent-color: #ff9500;">
                                    <span>Check buffer levels (target 10%)</span>
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; cursor: pointer;">
                                    <input type="checkbox" style="width: 20px; height: 20px; accent-color: #ff9500;">
                                    <span>Execute yield distribution</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" style="width: 20px; height: 20px; accent-color: #ff9500;">
                                    <span>Update REP leaderboard</span>
                                </label>
                            </div>

                            <!-- Action Buttons -->
                            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                <button onclick="runDistribution()" style="
                            padding: 14px 24px;
                            background: linear-gradient(135deg, #22c55e, #16a34a);
                            border: none;
                            border-radius: 12px;
                            color: white;
                            font-weight: 700;
                            cursor: pointer;
                        ">▶️ Run Distribution Now</button>
                                <button onclick="rebalanceBuffer()" style="
                            padding: 14px 24px;
                            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
                            border: none;
                            border-radius: 12px;
                            color: white;
                            font-weight: 700;
                            cursor: pointer;
                        ">⚖️ Rebalance Buffer</button>
                                <a href="docs/utility.html" style="
                            padding: 14px 24px;
                            background: #f3f4f6;
                            border: none;
                            border-radius: 12px;
                            color: #5a4a6f;
                            font-weight: 700;
                            text-decoration: none;
                        ">📖 View Docs</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PC Prompt Server Panel (Admin) -->
                <div id="panel-prompt-server" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">🖥️ PC Prompt Server</h2>
                        <p class="panel-desc">Remote coding system - send prompts to your PC's Antigravity</p>
                    </div>
                    <div class="section" id="section-prompt-server" data-section="prompt-server"
                        style="border: 2px solid rgba(34, 197, 94, 0.3); background: linear-gradient(135deg, rgba(34, 197, 94, 0.05), rgba(22, 163, 74, 0.05));">
                        <div class="section-header" onclick="toggleSection('prompt-server')">
                            <div class="section-info">
                                <h3 class="section-title">🖥️ PC Prompt Server</h3>
                                <div class="section-desc">Remote coding system - send prompts to PC Antigravity (Owner
                                    only)
                                </div>
                            </div>
                            <div class="section-toggle">▼</div>
                        </div>
                        <div class="section-content">
                            <div style="text-align: center; padding: 24px;">
                                <div style="font-size: 3rem; margin-bottom: 16px;">🖥️</div>
                                <p style="font-size: 1.1rem; color: #444; margin-bottom: 20px;">
                                    Send prompts to your PC's Antigravity from anywhere!
                                </p>
                                <a href="http://10.0.0.142:3000/" target="_blank" style="
                            display: inline-block;
                            padding: 16px 32px;
                            background: linear-gradient(135deg, #22c55e, #16a34a);
                            color: white;
                            font-weight: 700;
                            font-size: 1.1rem;
                            border-radius: 100px;
                            text-decoration: none;
                            box-shadow: 0 8px 30px rgba(34, 197, 94, 0.3);
                        ">🖥️ Open PC Prompt Server</a>
                                <p style="font-size: 0.85rem; color: #888; margin-top: 16px;">
                                    http://10.0.0.142:3000/
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Campaigns Panel -->
                <div id="panel-campaigns" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">📢 Campaigns</h2>
                        <p class="panel-desc">Pay users SUITE to try your app. Grow your user base with quality
                            engagement.</p>
                    </div>
                    <div class="section" id="section-campaigns" data-section="campaigns">
                        <div class="section-header" onclick="toggleSection('campaigns')">
                            <div class="section-info">
                                <h3 class="section-title">📢 Create Campaign</h3>
                                <div class="section-desc">Pay users SUITE to try your app. Grow your user base with
                                    quality
                                    engagement.</div>
                            </div>
                            <div class="section-toggle">▼</div>
                        </div>
                        <div class="section-content">
                            <p style="color: #666; margin-bottom: 24px;">Pay SUITE to get users to try your app. Set
                                requirements to ensure quality engagement.</p>

                            <form id="campaignForm">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Select App</label>
                                        <select id="appSelect" required>
                                            <option value="">Choose an app...</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Reward per User (SUITE)</label>
                                        <input type="number" id="rewardAmount" value="100" min="10" max="1000" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Total Budget (SUITE)</label>
                                        <input type="number" id="totalBudget" value="1000" min="100" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Max Claims (optional)</label>
                                        <input type="number" id="maxClaims" placeholder="Unlimited">
                                    </div>
                                </div>

                                <div style="margin-top: 24px;">
                                    <h4 style="margin-bottom: 16px; color: #444;">Requirements (Optional)</h4>
                                    <div class="form-grid">
                                        <div class="toggle-group">
                                            <input type="checkbox" id="requireTime">
                                            <div>
                                                <label for="requireTime">Minimum Time in App</label>
                                                <input type="number" id="minTime" placeholder="10"
                                                    style="width: 80px; margin-left: 12px;"> minutes
                                            </div>
                                        </div>
                                        <div class="toggle-group">
                                            <input type="checkbox" id="requireActions">
                                            <div>
                                                <label for="requireActions">Minimum Unique Actions</label>
                                                <input type="number" id="minActions" placeholder="50"
                                                    style="width: 80px; margin-left: 12px;"> actions
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div
                                    style="margin-top: 32px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
                                    <div style="color: #666;">
                                        Cost: <strong id="campaignCost" style="color: #ff9500; font-size: 1.2rem;">1,000
                                            SUITE</strong>
                                    </div>
                                    <button type="submit" class="btn-primary" id="createCampaignBtn">
                                        🚀 Launch Campaign
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Your Campaigns -->
                    <div class="section collapsed" id="section-my-campaigns" data-section="my-campaigns">
                        <div class="section-header" onclick="toggleSection('my-campaigns')">
                            <div class="section-info">
                                <h3 class="section-title">📊 Your Campaigns</h3>
                                <div class="section-desc">Track performance, claims, and budget for your active user
                                    acquisition
                                    campaigns.</div>
                            </div>
                            <div class="section-toggle">▼</div>
                        </div>
                    </div>
                </div>

                <!-- Reviews Panel -->
                <div id="panel-reviews" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">⭐ Reviews</h2>
                        <p class="panel-desc">Request and manage app reviews from the community.</p>
                    </div>
                    <div class="content-card">
                        <p style="color: #888; text-align: center; padding: 40px;">Coming soon - request authentic
                            reviews from
                            SUITE users!</p>
                    </div>
                </div>

                <!-- Power-Ups Panel -->
                <div id="panel-powerups" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">⚡ Power-Ups</h2>
                        <p class="panel-desc">Boost your app's visibility and features.</p>
                    </div>
                    <div class="content-card">
                        <p style="color: #888; text-align: center; padding: 40px;">Coming soon - featured placements,
                            boost badges,
                            and more!</p>
                    </div>
                </div>

                <!-- Cadence Panel -->
                <div id="panel-cadence" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">🎯 Cadence</h2>
                        <p class="panel-desc">Build daily habits and track your routines.</p>
                    </div>
                    <div class="iframe-container"
                        style="background: white; border-radius: 20px; overflow: hidden; height: calc(100vh - 200px); min-height: 500px;">
                        <iframe src="cadence.html" style="width: 100%; height: 100%; border: none;"></iframe>
                    </div>
                </div>

                <!-- Marketplace Panel -->
                <div id="panel-marketplace" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">📸 Content Marketplace</h2>
                        <p class="panel-desc">Post bounties for content, submit work, earn SUITE from the community.</p>
                    </div>
                    <div class="iframe-container"
                        style="background: white; border-radius: 20px; overflow: hidden; height: calc(100vh - 200px); min-height: 500px;">
                        <iframe src="content.html" style="width: 100%; height: 100%; border: none;"></iframe>
                    </div>
                </div>

                <!-- SUITEHub Panel -->
                <div id="panel-suitehub" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">🏠 SUITEHub</h2>
                        <p class="panel-desc">Your community hub for building and collaboration.</p>
                    </div>
                    <div class="iframe-container"
                        style="background: white; border-radius: 20px; overflow: hidden; height: calc(100vh - 200px); min-height: 500px;">
                        <iframe src="suitehub.html" style="width: 100%; height: 100%; border: none;"></iframe>
                    </div>
                </div>

                <!-- LP Incentives Panel (Admin) -->
                <div id="panel-lp-incentives" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">💧 LP Incentives</h2>
                        <p class="panel-desc">Manage liquidity provider incentives and rewards.</p>
                    </div>
                    <div class="content-card">
                        <p style="color: #888; text-align: center; padding: 40px;">Coming soon - LP staking rewards and
                            incentive
                            management.</p>
                    </div>
                </div>

                <!-- AI Fleet Panel (Public) -->
                <div id="panel-ai-fleet" class="section-panel">
                    <div class="panel-header"
                        style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div>
                            <h2 class="panel-title">🤖 AI Fleet Dashboard</h2>
                            <p class="panel-desc">Monitor and configure the autonomous AI app factory. Watch apps being
                                created in real-time.</p>
                        </div>
                        <a href="docs/ai-fleet.html"
                            style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; padding: 10px 18px; border-radius: 100px; font-size: 0.85rem; font-weight: 600; text-decoration: none; white-space: nowrap;">📚
                            Learn More</a>
                    </div>

                    <!-- TELOS Mode Hero Toggle -->
                    <div id="telosHeroSection"
                        style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.05)); border-radius: 20px; padding: 24px; margin-bottom: 24px; border: 2px solid rgba(99, 102, 241, 0.2);">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
                            <div>
                                <h3 style="margin: 0 0 8px 0; font-size: 1.3rem; font-weight: 800; color: #2d1b4e;">🎯
                                    TELOS MODE</h3>
                                <p id="telosStatusText" style="margin: 0; color: #5a4a6f; font-size: 0.95rem;">AI
                                    creates apps autonomously 24/7</p>
                            </div>
                            <!-- Big Toggle Switch (Owner Only) -->
                            <div id="telosToggleControls" style="display: flex; align-items: center; gap: 12px;">
                                <span id="telosOffLabel"
                                    style="font-size: 0.9rem; font-weight: 600; color: #888;">OFF</span>
                                <label class="telos-switch"
                                    style="position: relative; display: inline-block; width: 80px; height: 40px; cursor: pointer;">
                                    <input type="checkbox" id="telosMainToggle" onchange="toggleTelosMode()" checked
                                        style="opacity: 0; width: 0; height: 0;">
                                    <span id="telosSlider"
                                        style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, #22c55e, #16a34a); border-radius: 40px; transition: 0.4s; box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);"></span>
                                    <span id="telosKnob"
                                        style="position: absolute; height: 32px; width: 32px; left: 44px; bottom: 4px; background: white; border-radius: 50%; transition: 0.4s; box-shadow: 0 2px 6px rgba(0,0,0,0.2);"></span>
                                </label>
                                <span id="telosOnLabel"
                                    style="font-size: 0.9rem; font-weight: 700; color: #22c55e;">ON</span>
                            </div>
                            <!-- Status Badge (For Non-Owners) -->
                            <div id="telosStatusBadge"
                                style="display: none; padding: 10px 20px; background: rgba(34, 197, 94, 0.15); border-radius: 100px;">
                                <span style="font-weight: 700; color: #22c55e;">🟢 ACTIVE</span>
                            </div>
                        </div>
                        <!-- Status Explanation -->
                        <div id="telosExplanation"
                            style="margin-top: 16px; padding: 12px 16px; background: rgba(34, 197, 94, 0.1); border-radius: 12px; border-left: 4px solid #22c55e;">
                            <p style="margin: 0; font-size: 0.9rem; color: #16a34a; font-weight: 600;">✅ ACTIVE: AI is
                                researching markets, building apps, and deploying automatically.</p>
                        </div>
                    </div>

                    <!-- Human Priority Banner -->
                    <div id="humanPriorityBanner"
                        style="display: none; align-items: center; gap: 12px; margin-bottom: 24px; padding: 16px 20px; background: linear-gradient(135deg, rgba(255, 149, 0, 0.1), rgba(255, 107, 157, 0.05)); border-radius: 16px; border: 2px solid rgba(255, 149, 0, 0.3);">
                        <span style="font-size: 1.5rem;">👤</span>
                        <div style="flex: 1;">
                            <span style="font-weight: 700; color: #ff9500;">Human Request Active</span>
                            <p style="margin: 4px 0 0; font-size: 0.85rem; color: #5a4a6f;">TELOS paused — processing
                                your request first</p>
                        </div>
                        <span id="humanRequestCount"
                            style="background: #ff9500; color: white; padding: 6px 12px; border-radius: 100px; font-size: 0.85rem; font-weight: 700;">1
                            in queue</span>
                    </div>

                    <!-- Forge Connection Status -->
                    <div id="forgeStatusBar"
                        style="display: flex; align-items: center; gap: 12px; margin-bottom: 24px; padding: 12px 16px; background: white; border-radius: 12px; border: 1px solid rgba(0,0,0,0.06);">
                        <div id="forgeStatusDot"
                            style="width: 10px; height: 10px; background: #22c55e; border-radius: 50%; animation: pulse 2s infinite;">
                        </div>
                        <span id="forgeStatusText" style="font-weight: 600; color: #22c55e; font-size: 0.9rem;">🖥️
                            Forge (PC) Connected</span>
                        <span style="color: #888; font-size: 0.85rem; margin-left: auto;">Last sync: <span
                                id="forgeLastSync">Just now</span></span>
                    </div>

                    <!-- Stats Grid -->
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 16px; margin-bottom: 24px;">
                        <div
                            style="background: white; border-radius: 16px; padding: 20px; text-align: center; border: 1px solid rgba(0,0,0,0.06);">
                            <div style="font-size: 2rem; font-weight: 900; color: #6366f1;" id="aiFleetTotalApps">0
                            </div>
                            <div style="font-size: 0.85rem; color: #666; margin-top: 4px;">Total AI Apps</div>
                        </div>
                        <div
                            style="background: white; border-radius: 16px; padding: 20px; text-align: center; border: 1px solid rgba(0,0,0,0.06);">
                            <div style="font-size: 2rem; font-weight: 900; color: #22c55e;" id="aiFleetToday">0</div>
                            <div style="font-size: 0.85rem; color: #666; margin-top: 4px;">Created Today</div>
                        </div>
                        <div
                            style="background: white; border-radius: 16px; padding: 20px; text-align: center; border: 1px solid rgba(0,0,0,0.06);">
                            <div style="font-size: 2rem; font-weight: 900; color: #ff9500;" id="aiFleetInProgress">0
                            </div>
                            <div style="font-size: 0.85rem; color: #666; margin-top: 4px;">In Progress</div>
                        </div>
                        <div
                            style="background: white; border-radius: 16px; padding: 20px; text-align: center; border: 1px solid rgba(0,0,0,0.06);">
                            <div style="font-size: 2rem; font-weight: 900; color: #8b5cf6;" id="aiFleetIterations">0
                            </div>
                            <div style="font-size: 0.85rem; color: #666; margin-top: 4px;">Total Iterations</div>
                        </div>
                    </div>

                    <!-- Two Columns: Activity Feed & Config -->
                    <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 24px;">
                        <!-- Live Activity Feed -->
                        <div
                            style="background: #1a1a2e; border-radius: 16px; padding: 20px; color: white; max-height: 400px; overflow: hidden;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <h4 style="margin: 0; font-weight: 700;">🔴 Live Activity Feed</h4>
                                <span
                                    style="font-size: 0.75rem; color: #888; animation: pulse 2s infinite;">STREAMING</span>
                            </div>
                            <div id="aiActivityFeed"
                                style="font-family: 'Courier New', monospace; font-size: 0.8rem; line-height: 1.8; max-height: 320px; overflow-y: auto;">
                                <div style="color: #888;">— Loading activity feed... —</div>
                            </div>
                        </div>

                        <!-- Configuration Panel (Owner Only) -->
                        <div id="aiFleetConfigPanel"
                            style="background: white; border-radius: 16px; padding: 20px; border: 1px solid rgba(0,0,0,0.06);">
                            <h4 style="margin: 0 0 20px 0; font-weight: 700;">⚙️ Configuration</h4>

                            <div style="margin-bottom: 16px;">
                                <label
                                    style="font-size: 0.85rem; font-weight: 600; color: #555; display: block; margin-bottom: 6px;">Iterations
                                    per App</label>
                                <input type="number" id="configIterations" value="50" min="10" max="100"
                                    style="width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 10px; font-size: 1rem; font-weight: 700;">
                            </div>

                            <div style="margin-bottom: 16px;">
                                <label
                                    style="font-size: 0.85rem; font-weight: 600; color: #555; display: block; margin-bottom: 6px;">Max
                                    Apps per Day</label>
                                <input type="number" id="configMaxApps" value="6" min="1" max="20"
                                    style="width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 10px; font-size: 1rem; font-weight: 700;">
                            </div>

                            <div style="margin-bottom: 16px;">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="configAutoDeploy" checked
                                        style="width: 20px; height: 20px; accent-color: #22c55e;">
                                    <span style="font-weight: 600;">Auto-Deploy</span>
                                </label>
                                <p style="margin: 4px 0 0 30px; font-size: 0.8rem; color: #888;">Apps go live after
                                    iterations complete</p>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="configTelosEnabled" checked
                                        style="width: 20px; height: 20px; accent-color: #6366f1;">
                                    <span style="font-weight: 600;">Telos Mode</span>
                                </label>
                                <p style="margin: 4px 0 0 30px; font-size: 0.8rem; color: #888;">AI picks next project
                                    autonomously</p>
                            </div>

                            <button onclick="saveAIConfig()" class="btn-primary"
                                style="width: 100%; background: linear-gradient(135deg, #6366f1, #8b5cf6);">💾 Save
                                Configuration</button>
                        </div>
                    </div>

                    <!-- Research Focus -->
                    <div
                        style="margin-top: 24px; background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.05)); border-radius: 16px; padding: 20px; border: 1px solid rgba(251, 191, 36, 0.3);">
                        <h4 style="margin: 0 0 12px 0; font-weight: 700;">🔍 Current Research Focus</h4>
                        <p style="margin: 0 0 12px; color: #5a4a6f; font-size: 0.9rem;">The AI is currently exploring
                            these market categories for new app ideas:</p>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            <span
                                style="background: white; padding: 8px 14px; border-radius: 100px; font-size: 0.85rem; font-weight: 600;">📊
                                Productivity</span>
                            <span
                                style="background: white; padding: 8px 14px; border-radius: 100px; font-size: 0.85rem; font-weight: 600;">💪
                                Health</span>
                            <span
                                style="background: white; padding: 8px 14px; border-radius: 100px; font-size: 0.85rem; font-weight: 600;">💰
                                Finance</span>
                            <span
                                style="background: white; padding: 8px 14px; border-radius: 100px; font-size: 0.85rem; font-weight: 600;">🎨
                                Creativity</span>
                        </div>
                    </div>
                </div>

                <!-- Earn Panel -->
                <div id="panel-earn" class="section-panel">

                    <div class="panel-header">
                        <h2 class="panel-title">💰 Earn SUITE</h2>
                        <p class="panel-desc">Watch ads, complete tasks, and earn free SUITE tokens.</p>
                    </div>
                    <div class="content-card">
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                            <!-- Watch Ad -->
                            <div style="background: rgba(255, 149, 0, 0.08); border: 2px solid rgba(255, 149, 0, 0.2); border-radius: 16px; padding: 20px; cursor: pointer; transition: all 0.3s;"
                                onclick="window.location.href='earn.html'">
                                <div style="display: flex; align-items: center; gap: 16px;">
                                    <div
                                        style="font-size: 2rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; background: white; border-radius: 12px;">
                                        📺</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 700; font-size: 1.1rem; color: #2d1b4e;">Watch Video Ad
                                        </div>
                                        <div style="font-size: 0.9rem; color: #5a4a6f;">30 seconds</div>
                                    </div>
                                    <div
                                        style="background: linear-gradient(135deg, #ff9500, #ff6b9d); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800;">
                                        +2 SUITE</div>
                                </div>
                            </div>
                            <!-- Try App -->
                            <div style="background: rgba(255, 149, 0, 0.08); border: 2px solid rgba(255, 149, 0, 0.2); border-radius: 16px; padding: 20px; cursor: pointer; transition: all 0.3s;"
                                onclick="window.location.href='apps.html'">
                                <div style="display: flex; align-items: center; gap: 16px;">
                                    <div
                                        style="font-size: 2rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; background: white; border-radius: 12px;">
                                        📱</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 700; font-size: 1.1rem; color: #2d1b4e;">Try an App
                                        </div>
                                        <div style="font-size: 0.9rem; color: #5a4a6f;">Use for 5 minutes</div>
                                    </div>
                                    <div
                                        style="background: linear-gradient(135deg, #ff9500, #ff6b9d); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800;">
                                        +100 SUITE</div>
                                </div>
                            </div>
                            <!-- Daily Bonus -->
                            <div style="background: rgba(255, 149, 0, 0.08); border: 2px solid rgba(255, 149, 0, 0.2); border-radius: 16px; padding: 20px; cursor: pointer; transition: all 0.3s;"
                                onclick="window.location.href='earn.html'">
                                <div style="display: flex; align-items: center; gap: 16px;">
                                    <div
                                        style="font-size: 2rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; background: white; border-radius: 12px;">
                                        🎁</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 700; font-size: 1.1rem; color: #2d1b4e;">Daily Bonus
                                        </div>
                                        <div style="font-size: 0.9rem; color: #5a4a6f;">Claim once per day</div>
                                    </div>
                                    <div
                                        style="background: linear-gradient(135deg, #ff9500, #ff6b9d); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800;">
                                        +5 SUITE</div>
                                </div>
                            </div>
                            <!-- Referral -->
                            <div style="background: rgba(255, 149, 0, 0.08); border: 2px solid rgba(255, 149, 0, 0.2); border-radius: 16px; padding: 20px; cursor: pointer; transition: all 0.3s;"
                                onclick="window.location.href='earn.html'">
                                <div style="display: flex; align-items: center; gap: 16px;">
                                    <div
                                        style="font-size: 2rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; background: white; border-radius: 12px;">
                                        👥</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 700; font-size: 1.1rem; color: #2d1b4e;">Refer a Friend
                                        </div>
                                        <div style="font-size: 0.9rem; color: #5a4a6f;">Share your link</div>
                                    </div>
                                    <div
                                        style="background: linear-gradient(135deg, #ff9500, #ff6b9d); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800;">
                                        +25 SUITE</div>
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 24px;">
                            <a href="earn.html" class="btn-primary"
                                style="display: inline-block; text-decoration: none;">🚀 Open
                                Full Earn Page</a>
                        </div>
                    </div>
                </div>

                <!-- Store Panel -->
                <div id="panel-store" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">🛒 SUITE Store</h2>
                        <p class="panel-desc">Buy powerups and items with $SUITE to supercharge your apps.</p>
                    </div>
                    <div class="content-card">
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 16px;">
                            <!-- Priority Queue -->
                            <div
                                style="background: linear-gradient(to bottom, rgb(255, 210, 190) 50%, white 50%); border-radius: 16px; text-align: center; overflow: hidden;">
                                <div style="padding: 20px 16px 16px;">
                                    <div style="font-size: 3rem; margin-bottom: 8px;">⚡</div>
                                </div>
                                <div style="padding: 0 16px 20px; background: white;">
                                    <div style="font-weight: 800; margin-bottom: 6px;">Priority Queue</div>
                                    <div
                                        style="color: #ff9500; font-weight: 700; font-size: 0.85rem; margin-bottom: 12px;">
                                        500
                                        $SUITE</div>
                                    <button
                                        style="width: 100%; padding: 10px; background: linear-gradient(90deg, #ff8c42, #ff6b9d); border: none; border-radius: 50px; color: white; font-weight: 700; cursor: pointer;">BUY</button>
                                </div>
                            </div>
                            <!-- AI Pack -->
                            <div
                                style="background: linear-gradient(to bottom, rgb(255, 210, 190) 50%, white 50%); border-radius: 16px; text-align: center; overflow: hidden;">
                                <div style="padding: 20px 16px 16px;">
                                    <div style="font-size: 3rem; margin-bottom: 8px;">🤖</div>
                                </div>
                                <div style="padding: 0 16px 20px; background: white;">
                                    <div style="font-weight: 800; margin-bottom: 6px;">AI Pack</div>
                                    <div
                                        style="color: #ff9500; font-weight: 700; font-size: 0.85rem; margin-bottom: 12px;">
                                        200
                                        $SUITE</div>
                                    <button
                                        style="width: 100%; padding: 10px; background: linear-gradient(90deg, #ff8c42, #ff6b9d); border: none; border-radius: 50px; color: white; font-weight: 700; cursor: pointer;">BUY</button>
                                </div>
                            </div>
                            <!-- App Slot -->
                            <div
                                style="background: linear-gradient(to bottom, rgb(255, 210, 190) 50%, white 50%); border-radius: 16px; text-align: center; overflow: hidden;">
                                <div style="padding: 20px 16px 16px;">
                                    <div style="font-size: 3rem; margin-bottom: 8px;">📦</div>
                                </div>
                                <div style="padding: 0 16px 20px; background: white;">
                                    <div style="font-weight: 800; margin-bottom: 6px;">App Slot</div>
                                    <div
                                        style="color: #ff9500; font-weight: 700; font-size: 0.85rem; margin-bottom: 12px;">
                                        1,000
                                        $SUITE</div>
                                    <button
                                        style="width: 100%; padding: 10px; background: linear-gradient(90deg, #ff8c42, #ff6b9d); border: none; border-radius: 50px; color: white; font-weight: 700; cursor: pointer;">BUY</button>
                                </div>
                            </div>
                            <!-- Featured Week -->
                            <div
                                style="background: linear-gradient(to bottom, rgb(255, 210, 190) 50%, white 50%); border-radius: 16px; text-align: center; overflow: hidden;">
                                <div style="padding: 20px 16px 16px;">
                                    <div style="font-size: 3rem; margin-bottom: 8px;">⭐</div>
                                </div>
                                <div style="padding: 0 16px 20px; background: white;">
                                    <div style="font-weight: 800; margin-bottom: 6px;">Featured Week</div>
                                    <div
                                        style="color: #ff9500; font-weight: 700; font-size: 0.85rem; margin-bottom: 12px;">
                                        2,000
                                        $SUITE</div>
                                    <button
                                        style="width: 100%; padding: 10px; background: linear-gradient(90deg, #ff8c42, #ff6b9d); border: none; border-radius: 50px; color: white; font-weight: 700; cursor: pointer;">BUY</button>
                                </div>
                            </div>
                            <!-- 2x Earn -->
                            <div
                                style="background: linear-gradient(to bottom, rgb(255, 210, 190) 50%, white 50%); border-radius: 16px; text-align: center; overflow: hidden;">
                                <div style="padding: 20px 16px 16px;">
                                    <div style="font-size: 3rem; margin-bottom: 8px;">2️⃣</div>
                                </div>
                                <div style="padding: 0 16px 20px; background: white;">
                                    <div style="font-weight: 800; margin-bottom: 6px;">2x Earn</div>
                                    <div
                                        style="color: #ff9500; font-weight: 700; font-size: 0.85rem; margin-bottom: 12px;">
                                        500
                                        $SUITE</div>
                                    <button
                                        style="width: 100%; padding: 10px; background: linear-gradient(90deg, #ff8c42, #ff6b9d); border: none; border-radius: 50px; color: white; font-weight: 700; cursor: pointer;">BUY</button>
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 24px;">
                            <a href="boost.html" class="btn-primary"
                                style="display: inline-block; text-decoration: none;">🛒 Visit
                                Full Store</a>
                        </div>
                    </div>
                </div>

                <!-- Giving Panel -->
                <div id="panel-giving" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">💝 Giving</h2>
                        <p class="panel-desc">10% of SUITE treasury yield goes to charity. Vote on causes that matter.
                        </p>
                    </div>
                    <div class="iframe-container"
                        style="background: white; border-radius: 20px; overflow: hidden; height: calc(100vh - 200px); min-height: 500px;">
                        <iframe src="giving.html" style="width: 100%; height: 100%; border: none;"></iframe>
                    </div>
                </div>

                <!-- Content Studio Panel -->
                <div id="panel-studio" class="section-panel">
                    <div class="panel-header">
                        <h2 class="panel-title">🎥 Content Studio</h2>
                        <p class="panel-desc">Create stunning promo videos & voiceovers for your apps using AI.</p>
                    </div>
                    <div class="section" id="section-content-studio" data-section="content-studio"
                        style="border: 2px solid rgba(255, 107, 157, 0.3); background: linear-gradient(135deg, rgba(255, 107, 157, 0.05), rgba(255, 149, 0, 0.05));">
                        <div class="section-header" onclick="toggleSection('content-studio')">
                            <div class="section-info">
                                <h3 class="section-title">🎥 Content Studio</h3>
                                <div class="section-desc">Create stunning promo videos & voiceovers for your apps using
                                    AI</div>
                            </div>
                            <div class="section-toggle">▼</div>
                        </div>
                        <div class="section-content">
                            <!-- Owner Badge (shown for Stuart) -->
                            <div id="studioOwnerBadge"
                                style="display: none; background: linear-gradient(135deg, #22c55e, #16a34a); color: white; padding: 12px 20px; border-radius: 12px; margin-bottom: 24px; display: flex; align-items: center; gap: 12px;">
                                <span style="font-size: 1.5rem;">👑</span>
                                <div>
                                    <div style="font-weight: 700;">Owner Access</div>
                                    <div style="font-size: 0.85rem; opacity: 0.9;">All content generation is FREE for
                                        you!</div>
                                </div>
                            </div>

                            <!-- Video Generation -->
                            <div style="background: white; border-radius: 20px; padding: 28px; margin-bottom: 20px;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 16px; margin-bottom: 20px;">
                                    <div>
                                        <h4
                                            style="font-size: 1.2rem; font-weight: 800; margin: 0 0 8px 0; display: flex; align-items: center; gap: 8px;">
                                            🎬 Video Clips (Veo 2)
                                        </h4>
                                        <p style="color: #666; font-size: 0.9rem; margin: 0;">Generate 8-second
                                            claymation-style
                                            promo clips</p>
                                    </div>
                                    <div id="videoPricingBadge"
                                        style="background: linear-gradient(135deg, #ff9500, #ff6b9d); color: white; padding: 8px 16px; border-radius: 100px; font-weight: 700; font-size: 0.85rem;">
                                        100 SUITE / clip
                                    </div>
                                </div>

                                <!-- Template Selection -->
                                <div style="margin-bottom: 20px;">
                                    <label
                                        style="font-weight: 700; font-size: 0.9rem; color: #444; display: block; margin-bottom: 8px;">Choose
                                        Template</label>
                                    <div
                                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px;">
                                        <label style="cursor: pointer;">
                                            <input type="radio" name="videoTemplate" value="builder-journey" checked
                                                style="display: none;">
                                            <div class="template-option"
                                                style="background: rgba(255, 149, 0, 0.1); border: 2px solid #ff9500; padding: 16px; border-radius: 12px; text-align: center;">
                                                <div style="font-size: 1.5rem; margin-bottom: 8px;">🚀</div>
                                                <div style="font-weight: 700; font-size: 0.9rem;">Builder Journey</div>
                                                <div style="font-size: 0.75rem; color: #666;">6 panels</div>
                                            </div>
                                        </label>
                                        <label style="cursor: pointer;">
                                            <input type="radio" name="videoTemplate" value="app-launch"
                                                style="display: none;">
                                            <div class="template-option"
                                                style="background: #f8f9fa; border: 2px solid transparent; padding: 16px; border-radius: 12px; text-align: center;">
                                                <div style="font-size: 1.5rem; margin-bottom: 8px;">📱</div>
                                                <div style="font-weight: 700; font-size: 0.9rem;">App Launch</div>
                                                <div style="font-size: 0.75rem; color: #666;">4 panels</div>
                                            </div>
                                        </label>
                                        <label style="cursor: pointer;">
                                            <input type="radio" name="videoTemplate" value="feature-highlight"
                                                style="display: none;">
                                            <div class="template-option"
                                                style="background: #f8f9fa; border: 2px solid transparent; padding: 16px; border-radius: 12px; text-align: center;">
                                                <div style="font-size: 1.5rem; margin-bottom: 8px;">✨</div>
                                                <div style="font-weight: 700; font-size: 0.9rem;">Feature Highlight
                                                </div>
                                                <div style="font-size: 0.75rem; color: #666;">3 panels</div>
                                            </div>
                                        </label>
                                        <label style="cursor: pointer;">
                                            <input type="radio" name="videoTemplate" value="custom"
                                                style="display: none;">
                                            <div class="template-option"
                                                style="background: #f8f9fa; border: 2px solid transparent; padding: 16px; border-radius: 12px; text-align: center;">
                                                <div style="font-size: 1.5rem; margin-bottom: 8px;">🎨</div>
                                                <div style="font-weight: 700; font-size: 0.9rem;">Custom</div>
                                                <div style="font-size: 0.75rem; color: #666;">Your idea</div>
                                            </div>
                                        </label>
                                    </div>
                                </div>

                                <!-- Custom Prompt (shown for custom template) -->
                                <div id="customPromptSection" style="display: none; margin-bottom: 20px;">
                                    <label
                                        style="font-weight: 700; font-size: 0.9rem; color: #444; display: block; margin-bottom: 8px;">Describe
                                        Your Video</label>
                                    <textarea id="customVideoPrompt"
                                        placeholder="Describe what you want in your claymation video..."
                                        style="width: 100%; padding: 14px; border: 2px solid #eee; border-radius: 12px; font-size: 1rem; min-height: 100px; resize: vertical;"></textarea>
                                </div>

                                <!-- App Selection -->
                                <div style="margin-bottom: 20px;">
                                    <label
                                        style="font-weight: 700; font-size: 0.9rem; color: #444; display: block; margin-bottom: 8px;">Select
                                        App (optional)</label>
                                    <select id="videoAppSelect"
                                        style="width: 100%; padding: 14px; border: 2px solid #eee; border-radius: 12px; font-size: 1rem;">
                                        <option value="">General promo video</option>
                                    </select>
                                </div>

                                <!-- Pricing Tiers -->
                                <div
                                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 20px;">
                                    <label style="cursor: pointer;">
                                        <input type="radio" name="videoPriority" value="batch" style="display: none;">
                                        <div class="priority-option"
                                            style="background: #f8f9fa; border: 2px solid transparent; padding: 16px; border-radius: 12px;">
                                            <div style="font-weight: 700; margin-bottom: 4px;">📦 Batch</div>
                                            <div style="font-size: 0.85rem; color: #666;">24-hour delivery</div>
                                            <div style="font-weight: 800; color: #22c55e; margin-top: 8px;"
                                                id="batchPrice">50
                                                SUITE</div>
                                        </div>
                                    </label>
                                    <label style="cursor: pointer;">
                                        <input type="radio" name="videoPriority" value="priority" checked
                                            style="display: none;">
                                        <div class="priority-option"
                                            style="background: rgba(255, 149, 0, 0.1); border: 2px solid #ff9500; padding: 16px; border-radius: 12px;">
                                            <div style="font-weight: 700; margin-bottom: 4px;">⚡ Priority</div>
                                            <div style="font-size: 0.85rem; color: #666;">1-2 hour delivery</div>
                                            <div style="font-weight: 800; color: #ff9500; margin-top: 8px;"
                                                id="priorityPrice">
                                                100 SUITE</div>
                                        </div>
                                    </label>
                                </div>

                                <button onclick="generateVideo()" class="btn-primary" style="width: 100%;">
                                    🎬 Generate Video Clips
                                </button>
                            </div>

                            <!-- Voice Generation -->
                            <div style="background: white; border-radius: 20px; padding: 28px; margin-bottom: 20px;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 16px; margin-bottom: 20px;">
                                    <div>
                                        <h4
                                            style="font-size: 1.2rem; font-weight: 800; margin: 0 0 8px 0; display: flex; align-items: center; gap: 8px;">
                                            🎙️ Voice Generation (ElevenLabs)
                                        </h4>
                                        <p style="color: #666; font-size: 0.9rem; margin: 0;">Professional voiceovers
                                            for your
                                            videos and apps</p>
                                    </div>
                                </div>

                                <!-- Voice Selection -->
                                <div style="margin-bottom: 20px;">
                                    <label
                                        style="font-weight: 700; font-size: 0.9rem; color: #444; display: block; margin-bottom: 8px;">Select
                                        Voice</label>
                                    <div
                                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                                        <label style="cursor: pointer;">
                                            <input type="radio" name="voiceSelect" value="adam" checked
                                                style="display: none;">
                                            <div class="voice-option"
                                                style="background: rgba(99, 102, 241, 0.1); border: 2px solid #6366f1; padding: 16px; border-radius: 12px; text-align: center;">
                                                <div style="font-size: 1.5rem; margin-bottom: 8px;">👨</div>
                                                <div style="font-weight: 700;">Adam</div>
                                                <div style="font-size: 0.75rem; color: #666;">Male</div>
                                            </div>
                                        </label>
                                        <label style="cursor: pointer;">
                                            <input type="radio" name="voiceSelect" value="rachel"
                                                style="display: none;">
                                            <div class="voice-option"
                                                style="background: #f8f9fa; border: 2px solid transparent; padding: 16px; border-radius: 12px; text-align: center;">
                                                <div style="font-size: 1.5rem; margin-bottom: 8px;">👩</div>
                                                <div style="font-weight: 700;">Rachel</div>
                                                <div style="font-size: 0.75rem; color: #666;">Female</div>
                                            </div>
                                        </label>
                                        <label style="cursor: pointer;">
                                            <input type="radio" name="voiceSelect" value="sam" style="display: none;">
                                            <div class="voice-option"
                                                style="background: #f8f9fa; border: 2px solid transparent; padding: 16px; border-radius: 12px; text-align: center;">
                                                <div style="font-size: 1.5rem; margin-bottom: 8px;">🧑</div>
                                                <div style="font-weight: 700;">Sam</div>
                                                <div style="font-size: 0.75rem; color: #666;">Neutral</div>
                                            </div>
                                        </label>
                                    </div>
                                </div>

                                <!-- Voice Script -->
                                <div style="margin-bottom: 20px;">
                                    <label
                                        style="font-weight: 700; font-size: 0.9rem; color: #444; display: block; margin-bottom: 8px;">Script</label>
                                    <textarea id="voiceScript" placeholder="Enter the text you want spoken..."
                                        style="width: 100%; padding: 14px; border: 2px solid #eee; border-radius: 12px; font-size: 1rem; min-height: 80px; resize: vertical;"></textarea>
                                    <div
                                        style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 0.85rem; color: #888;">
                                        <span>Suggested: "Build. Earn. Give."</span>
                                        <span id="voiceCharCount">0 / 500 chars</span>
                                    </div>
                                </div>

                                <!-- Voice Pricing -->
                                <div
                                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin-bottom: 20px;">
                                    <label style="cursor: pointer;">
                                        <input type="radio" name="voicePriority" value="standard" checked
                                            style="display: none;">
                                        <div class="priority-option"
                                            style="background: rgba(99, 102, 241, 0.1); border: 2px solid #6366f1; padding: 16px; border-radius: 12px;">
                                            <div style="font-weight: 700; margin-bottom: 4px;">🎤 Standard</div>
                                            <div style="font-size: 0.85rem; color: #666;">Pre-made voices</div>
                                            <div style="font-weight: 800; color: #6366f1; margin-top: 8px;"
                                                id="voiceStandardPrice">
                                                50 SUITE</div>
                                        </div>
                                    </label>
                                    <label style="cursor: pointer;">
                                        <input type="radio" name="voicePriority" value="clone" style="display: none;">
                                        <div class="priority-option"
                                            style="background: #f8f9fa; border: 2px solid transparent; padding: 16px; border-radius: 12px;">
                                            <div style="font-weight: 700; margin-bottom: 4px;">🧬 Voice Clone</div>
                                            <div style="font-size: 0.85rem; color: #666;">Clone your own voice</div>
                                            <div style="font-weight: 800; color: #8b5cf6; margin-top: 8px;"
                                                id="voiceClonePrice">200
                                                SUITE</div>
                                        </div>
                                    </label>
                                </div>

                                <button onclick="generateVoice()" class="btn-primary"
                                    style="width: 100%; background: linear-gradient(135deg, #6366f1, #8b5cf6);">
                                    🎙️ Generate Voiceover
                                </button>
                            </div>

                            <!-- Your Content Orders -->
                            <div style="background: #f8f9fa; border-radius: 16px; padding: 24px;">
                                <h4 style="font-weight: 700; margin: 0 0 16px 0;">📋 Your Orders</h4>
                                <div id="contentOrdersList">
                                    <div class="empty-state" style="padding: 20px;">
                                        <p style="color: #888; margin: 0;">No content orders yet. Generate your first
                                            video or
                                            voiceover above!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        </div>

        <!-- Content Marketplace Panel -->
        <div id="panel-marketplace" class="section-panel">
            <div class="panel-header">
                <h2 class="panel-title">📸 Content Marketplace</h2>
                <p class="panel-desc">Post bounties for content, submit work, earn SUITE from the community.</p>
            </div>
            <div class="section" id="section-marketplace" data-section="marketplace"
                style="border: 2px solid rgba(139, 92, 246, 0.3); background: linear-gradient(135deg, rgba(139, 92, 246, 0.05), rgba(99, 102, 241, 0.05));">
                <div class="section-header" onclick="toggleSection('marketplace')">
                    <div class="section-info">
                        <h3 class="section-title">📸 Content Marketplace</h3>
                        <div class="section-desc">Post bounties for content, submit work, earn SUITE from the
                            community
                        </div>
                    </div>
                    <div class="section-toggle">▼</div>
                </div>
                <div class="section-content">
                    <!-- Marketplace Stats -->
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 24px;">
                        <div style="background: white; border-radius: 16px; padding: 20px; text-align: center;">
                            <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 4px;">Open Bounties
                            </div>
                            <div style="font-size: 1.8rem; font-weight: 900; color: #ff9500;"
                                id="dashboardOpenBounties">—
                            </div>
                        </div>
                        <div style="background: white; border-radius: 16px; padding: 20px; text-align: center;">
                            <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 4px;">SUITE Paid Out
                            </div>
                            <div style="font-size: 1.8rem; font-weight: 900; color: #22c55e;" id="dashboardTotalPaid">—
                            </div>
                        </div>
                        <div style="background: white; border-radius: 16px; padding: 20px; text-align: center;">
                            <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 4px;">Your Submissions
                            </div>
                            <div style="font-size: 1.8rem; font-weight: 900; color: #6366f1;"
                                id="dashboardYourSubmissions">
                                —</div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div style="display: flex; gap: 12px; margin-bottom: 24px; flex-wrap: wrap;">
                        <button onclick="openBountyModal()" style="
                            display: inline-flex;
                            align-items: center;
                            gap: 8px;
                            padding: 14px 28px;
                            background: linear-gradient(135deg, #8b5cf6, #6366f1);
                            color: white;
                            border: none;
                            border-radius: 100px;
                            font-weight: 700;
                            font-size: 1rem;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        " onmouseover="this.style.transform='translateY(-2px)'"
                            onmouseout="this.style.transform='translateY(0)'">
                            📝 Post a Bounty
                        </button>
                        <a href="content.html" style="
                            display: inline-flex;
                            align-items: center;
                            gap: 8px;
                            padding: 14px 28px;
                            background: rgba(255, 255, 255, 0.9);
                            color: #2d1b4e;
                            border: 1px solid rgba(0, 0, 0, 0.1);
                            border-radius: 100px;
                            font-weight: 700;
                            font-size: 1rem;
                            text-decoration: none;
                            transition: all 0.3s ease;
                        " onmouseover="this.style.background='white'"
                            onmouseout="this.style.background='rgba(255, 255, 255, 0.9)'">
                            🔍 Browse All Bounties
                        </a>
                    </div>

                    <!-- Featured Bounties -->
                    <h4 style="font-weight: 700; margin: 0 0 16px 0;">🔥 Featured Bounties</h4>
                    <div id="featuredBounties"
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; margin-bottom: 24px;">
                        <!-- Will be populated by JS -->
                        <div
                            style="background: white; border-radius: 16px; padding: 24px; text-align: center; color: #888;">
                            Loading bounties...
                        </div>
                    </div>

                    <!-- Your Bounties -->
                    <h4 style="font-weight: 700; margin: 0 0 16px 0;">📋 Your Posted Bounties</h4>
                    <div id="yourBounties" style="background: #f8f9fa; border-radius: 16px; padding: 20px;">
                        <div class="empty-state" style="padding: 20px; text-align: center;">
                            <p style="color: #888; margin: 0;">You haven't posted any bounties yet. Post one to
                                get
                                content for your apps!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        </main>
    </div>
    </div>

    <script>
        // Show LP Incentives section only for admin (Stuart)
        const isAdmin = true; // TODO: Check actual admin status
        if (isAdmin) {
            document.getElementById('lpIncentivesSection').style.display = 'block';
        }

        // Calculate estimated APY when inputs change
        function updateApyEstimate() {
            const amount = parseFloat(document.getElementById('lpIncentiveAmount').value) || 0;
            const months = parseInt(document.getElementById('lpIncentiveDuration').value);
            const monthlyAmount = amount / months;

            document.getElementById('monthlyEmission').textContent = monthlyAmount.toLocaleString() + ' SUITE';

            // Assuming pool TVL and SUITE price - this would be dynamic in prod
            const poolTvl = 3500; // $3500 example
            const yearlyRewards = monthlyAmount * 12;
            const apy = (yearlyRewards / poolTvl) * 100;
            document.getElementById('estimatedApy').textContent = apy.toFixed(1) + '%';
        }

        document.getElementById('lpIncentiveAmount')?.addEventListener('input', updateApyEstimate);
        document.getElementById('lpIncentiveDuration')?.addEventListener('change', updateApyEstimate);

        function allocateLpIncentives() {
            alert('LP Incentive allocation will be connected to smart contract. Coming soon!');
        }
    </script>
    <div id="editAppModal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; align-items: center; justify-content: center;">
        <div
            style="background: white; border-radius: 24px; padding: 32px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <h3 style="font-size: 1.5rem; font-weight: 800; margin: 0;">✏️ Edit App</h3>
                <button onclick="closeEditAppModal()"
                    style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">×</button>
            </div>

            <form id="editAppForm">
                <input type="hidden" id="editAppId">

                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="font-weight: 700; display: block; margin-bottom: 8px;">App Name</label>
                    <input type="text" id="editAppName" disabled
                        style="padding: 14px; border: 2px solid #eee; border-radius: 12px; width: 100%; background: #f8f9fa;">
                </div>

                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="font-weight: 700; display: block; margin-bottom: 8px;">Icon URL</label>
                    <input type="url" id="editAppIconUrl" placeholder="https://example.com/icon.png"
                        style="padding: 14px; border: 2px solid #eee; border-radius: 12px; width: 100%;">
                    <small style="color: #888; font-size: 0.8rem;">Upload your icon to Imgur, Discord CDN,
                        or your
                        own hosting</small>
                    <div id="iconPreview" style="margin-top: 12px; text-align: center;"></div>
                </div>

                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="font-weight: 700; display: block; margin-bottom: 8px;">Description</label>
                    <textarea id="editAppDescription" placeholder="What does your app do?" rows="3"
                        style="padding: 14px; border: 2px solid #eee; border-radius: 12px; width: 100%; resize: vertical;"></textarea>
                </div>

                <div class="form-group" style="margin-bottom: 24px;">
                    <label style="font-weight: 700; display: block; margin-bottom: 8px;">Category</label>
                    <select id="editAppCategory"
                        style="padding: 14px; border: 2px solid #eee; border-radius: 12px; width: 100%;">
                        <option value="productivity">Productivity</option>
                        <option value="health">Health & Fitness</option>
                        <option value="finance">Finance</option>
                        <option value="lifestyle">Lifestyle</option>
                        <option value="entertainment">Entertainment</option>
                        <option value="education">Education</option>
                        <option value="utilities">Utilities</option>
                        <option value="social">Social</option>
                    </select>
                </div>

                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button type="button" onclick="closeEditAppModal()"
                        style="padding: 14px 24px; border: 2px solid #eee; background: white; border-radius: 12px; cursor: pointer; font-weight: 600;">Cancel</button>
                    <button type="submit" class="btn-primary" style="padding: 14px 24px;">💾 Save
                        Changes</button>
                </div>
            </form>
        </div>
    </div>
    </div>









    <script>

        const SUPABASE_URL = 'https://rdsmdywbdiskxknluiym.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJkc21keXdiZGlza3hrbmx1aXltIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3ODk3MTgsImV4cCI6MjA4MzM2NTcxOH0.DcLpWs8Lf1s4Flf54J5LubokSYrd7h-XvI_X0jj6bLM';
        const DISCORD_CLIENT_ID = '1457474266390986865';
        const REDIRECT_URI = window.location.origin + '/dashboard.html';

        let currentUser = null;

        // ========== COLLAPSIBLE SECTIONS ==========
        function toggleSection(sectionName) {
            const section = document.getElementById(`section-${sectionName}`);
            if (!section) return;

            section.classList.toggle('collapsed');

            // Save state to localStorage
            const states = JSON.parse(localStorage.getItem('dashboardSections') || '{ }');
            states[sectionName] = section.classList.contains('collapsed');
            localStorage.setItem('dashboardSections', JSON.stringify(states));
        }

        function initSectionStates() {
            const states = JSON.parse(localStorage.getItem('dashboardSections') || '{ }');

            // Default: apps open, others collapsed
            const defaults = {
                'campaigns': true,
                'my-campaigns': true,
                'apps': false,  // Open by default
                'reviews': true,
                'powerups': true
            };

            Object.keys(defaults).forEach(sectionName => {
                const section = document.getElementById(`section-${sectionName}`);
                if (!section) return;

                const isCollapsed = states[sectionName] !== undefined ? states[sectionName] : defaults[sectionName];
                if (isCollapsed) {
                    section.classList.add('collapsed');
                } else {
                    section.classList.remove('collapsed');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Initialize collapsible sections
            initSectionStates();

            const hash = window.location.hash.substring(1);
            const params = new URLSearchParams(hash);
            const accessToken = params.get('access_token');

            if (accessToken) {
                handleOAuthCallback(accessToken);
            } else {
                const savedUser = localStorage.getItem('suiteDev');
                if (savedUser) {
                    currentUser = JSON.parse(savedUser);
                    showDashboard();
                }
            }
        });

        function loginWithDiscord() {
            const authUrl = `https://discord.com/api/oauth2/authorize?client_id=${DISCORD_CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=token&scope=identify`;
            window.location.href = authUrl;
        }

        async function handleOAuthCallback(accessToken) {
            try {
                const response = await fetch('https://discord.com/api/users/@me', {
                    headers: { 'Authorization': `Bearer ${accessToken}` }
                });
                const user = await response.json();

                currentUser = {
                    id: user.id,
                    username: user.username,
                    avatar: user.avatar
                        ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`
                        : `https://cdn.discordapp.com/embed/avatars/${parseInt(user.discriminator || '0') % 5}.png`
                };

                localStorage.setItem('suiteDev', JSON.stringify(currentUser));
                history.replaceState(null, '', window.location.pathname);
                showDashboard();
            } catch (error) {
                console.error('OAuth error:', error);
                alert('Login failed. Please try again.');
            }
        }

        function showDashboard() {
            // Hide login banner, show user pill
            document.getElementById('loginBanner').style.display = 'none';
            document.getElementById('userPill').style.display = 'flex';
            document.getElementById('userName').textContent = currentUser.username;
            document.getElementById('userAvatar').src = currentUser.avatar;

            loadDevData();
        }

        async function loadDevData() {
            await Promise.all([
                loadApps(),
                loadCampaigns(),
                loadBalance()
            ]);
        }

        async function loadApps() {
            try {
                // Query suite_apps table for apps created by this user
                const url = `${SUPABASE_URL}/rest/v1/suite_apps?creator_discord_id=eq.${currentUser.id}&select=*`;
                console.log('?? Loading apps for Discord ID:', currentUser.id);
                console.log('?? API URL:', url);

                const response = await fetch(url, {
                    headers: { 'apikey': SUPABASE_ANON_KEY, 'Authorization': `Bearer ${SUPABASE_ANON_KEY}` }
                });
                const apps = await response.json();

                console.log('?? API Response:', apps);
                console.log('📱 Apps count:', Array.isArray(apps) ? apps.length : 'Not an array');

                document.getElementById('totalApps').textContent = Array.isArray(apps) ? apps.length : 0;

                const select = document.getElementById('appSelect');
                const powerupSelect = document.getElementById('powerupAppSelect');
                const reviewSelect = document.getElementById('reviewAppSelect');
                select.innerHTML = '<option value="">Choose an app...</option>';
                if (powerupSelect) powerupSelect.innerHTML = '<option value="">Choose an app...</option>';
                if (reviewSelect) reviewSelect.innerHTML = '<option value="">Choose an app...</option>';

                if (Array.isArray(apps)) {
                    apps.forEach(app => {
                        const option = `<option value="${app.id}">${app.name}</option>`;
                        select.innerHTML += option;
                        if (powerupSelect) powerupSelect.innerHTML += option;
                        if (reviewSelect) reviewSelect.innerHTML += option;
                    });
                }

                const appsList = document.getElementById('appsList');
                if (!Array.isArray(apps) || apps.length === 0) {
                    appsList.innerHTML = '<div class="empty-state"><p>No apps yet. <a href="start-building.html" style="color: #ff9500;">Submit your first app!</a></p></div>';
                } else {
                    appsList.innerHTML = apps.map(app => `
                        <div class="campaign-item">
                            <div class="campaign-info">
                                <img src="${app.icon_url || 'assets/suite-mascot.png'}" alt="${app.name}" style="border-radius: 12px;" onerror="this.src='assets/suite-mascot.png'">
                                <div>
                                    <strong>${app.name}</strong>
                                    <div style="font-size: 0.85rem; color: #888;">${app.tagline || app.description || 'No description'}</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <button onclick="openEditAppModal('${app.id}', '${app.name}', '${app.icon_url || ''}', '${(app.description || '').replace(/'/g, "\\'")}', '${app.category || ''}')" 
                                    style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; border: none; padding: 8px 16px; border-radius: 20px; font-weight: 600; cursor: pointer;">
                                    ✏️ Edit
                                </button>
                                <span class="badge badge-${app.status === 'published' || app.status === 'approved' ? 'active' : 'paused'}">${app.status || 'development'}</span>
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading apps:', error);
                document.getElementById('totalApps').textContent = '0';
            }
        }

        async function loadCampaigns() {
            try {
                // Note: app_campaigns references suite_apps via app_id
                const response = await fetch(`${SUPABASE_URL}/rest/v1/app_campaigns?developer_discord_id=eq.${currentUser.id}&select=*,suite_apps(name,icon_url)`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY, 'Authorization': `Bearer ${SUPABASE_ANON_KEY}` }
                });
                const campaigns = await response.json();

                if (!Array.isArray(campaigns)) {
                    document.getElementById('totalCampaigns').textContent = '0';
                    document.getElementById('totalClaims').textContent = '0';
                    return;
                }

                const active = campaigns.filter(c => c.status === 'active');
                document.getElementById('totalCampaigns').textContent = active.length;
                document.getElementById('totalClaims').textContent = campaigns.reduce((sum, c) => sum + (c.claims_count || 0), 0).toLocaleString();

                const list = document.getElementById('campaignsList');
                if (campaigns.length === 0) {
                    list.innerHTML = '<div class="empty-state"><p>No campaigns yet. Create one above!</p></div>';
                } else {
                    list.innerHTML = campaigns.map(c => `
                        <div class="campaign-item">
                            <div class="campaign-info">
                                <img src="${c.suite_apps?.icon_url || 'assets/suite-mascot.png'}" alt="" style="border-radius: 12px;">
                                <div>
                                    <strong>${c.suite_apps?.name || 'Unknown App'}</strong>
                                    <div style="font-size: 0.85rem; color: #888;">+${c.suite_per_claim} SUITE per user</div>
                                </div>
                            </div>
                            <div class="campaign-stats">
                                <span><strong>${c.claims_count || 0}</strong> Claims</span>
                                <span><strong>${c.remaining_budget?.toLocaleString() || 0}</strong> Budget Left</span>
                            </div>
                            <span class="badge badge-${c.status}">${c.status}</span>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading campaigns:', error);
                document.getElementById('totalCampaigns').textContent = '0';
                document.getElementById('totalClaims').textContent = '0';
            }
        }

        async function loadBalance() {
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/user_credits?discord_id=eq.${currentUser.id}&select=suite_balance`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY, 'Authorization': `Bearer ${SUPABASE_ANON_KEY}` }
                });
                const data = await response.json();
                const balance = data[0]?.suite_balance || 0;
                document.getElementById('suiteBalance').textContent = balance;
            } catch (error) {
                console.error('Error loading balance:', error);
            }
        }

        // Update cost display
        document.getElementById('totalBudget').addEventListener('input', (e) => {
            document.getElementById('campaignCost').textContent = parseInt(e.target.value || 0).toLocaleString() + ' SUITE';
        });

        // Form submission
        document.getElementById('campaignForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const appId = document.getElementById('appSelect').value;
            const rewardAmount = parseInt(document.getElementById('rewardAmount').value);
            const totalBudget = parseInt(document.getElementById('totalBudget').value);
            const maxClaims = document.getElementById('maxClaims').value ? parseInt(document.getElementById('maxClaims').value) : null;
            const requireTime = document.getElementById('requireTime').checked;
            const minTime = requireTime ? parseInt(document.getElementById('minTime').value || 10) * 60 : 0;
            const requireActions = document.getElementById('requireActions').checked;
            const minActions = requireActions ? parseInt(document.getElementById('minActions').value || 50) : 0;

            if (!appId) {
                alert('Please select an app');
                return;
            }

            // Check balance
            const balance = parseInt(document.getElementById('suiteBalance').textContent);
            if (balance < totalBudget) {
                alert(`Insufficient SUITE balance. You have ${balance} but need ${totalBudget}.`);
                return;
            }

            try {
                const btn = document.getElementById('createCampaignBtn');
                btn.disabled = true;
                btn.textContent = 'Creating...';

                const response = await fetch('/api/create-campaign', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        app_id: appId,
                        developer_discord_id: currentUser.id,
                        suite_per_claim: rewardAmount,
                        total_budget: totalBudget,
                        max_claims: maxClaims,
                        require_time: requireTime,
                        min_time_seconds: minTime,
                        require_actions: requireActions,
                        min_actions: minActions
                    })
                });

                const result = await response.json();

                if (result.success) {
                    alert('Campaign created successfully!');
                    await loadDevData();
                    document.getElementById('campaignForm').reset();
                } else {
                    alert(result.error || 'Failed to create campaign');
                }

                btn.disabled = false;
                btn.textContent = '🚀 Launch Campaign';
            } catch (error) {
                console.error('Error creating campaign:', error);
                alert('Error creating campaign');
            }
        });

        function logout() {
            localStorage.removeItem('suiteDev');
            currentUser = null;
            // Show login banner, hide user pill, reset to dashes
            document.getElementById('loginBanner').style.display = 'flex';
            document.getElementById('userPill').style.display = 'none';
            // Reset to dashes (not logged in state)
            document.getElementById('totalApps').textContent = '-';
            document.getElementById('totalCampaigns').textContent = '-';
            document.getElementById('totalClaims').textContent = '-';
            document.getElementById('suiteBalance').textContent = '-';
        }

        // ========== POWER-UP FUNCTIONS ==========

        let userApps = []; // Store apps for power-up dropdown

        async function loadPowerups() {
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/store_powerups?creator_discord_id=eq.${currentUser.id}&select=*`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY, 'Authorization': `Bearer ${SUPABASE_ANON_KEY}` }
                });
                const powerups = await response.json();

                const list = document.getElementById('powerupsList');
                if (!powerups || powerups.length === 0) {
                    list.innerHTML = '<div class="empty-state"><p>No power-ups yet. Create your first one above!</p></div>';
                } else {
                    list.innerHTML = powerups.map(p => `
                        <div class="campaign-item">
                            <div class="campaign-info">
                                <div style="font-size: 2rem; margin-right: 8px;">${p.icon || '?'}</div>
                                <div>
                                    <strong>${p.name}</strong>
                                    <div style="font-size: 0.85rem; color: #888;">${p.description}</div>
                                </div>
                            </div>
                            <div class="campaign-stats">
                                <span><strong>${p.total_sales || 0}</strong> Sales</span>
                                <span><strong>${p.price}</strong> SUITE</span>
                            </div>
                            <span class="badge ${p.status === 'active' ? 'badge-active' : 'badge-paused'}">${p.status || 'pending'}</span>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading power-ups:', error);
            }
        }

        function populatePowerupAppSelect(apps) {
            userApps = apps;
            const select = document.getElementById('powerupAppSelect');
            select.innerHTML = '<option value="">Choose an app...</option>';
            apps.forEach(app => {
                select.innerHTML += `<option value="${app.id}">${app.name}</option>`;
            });
        }

        // Power-up form submission
        document.getElementById('powerupForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const appId = document.getElementById('powerupAppSelect').value;
            const name = document.getElementById('powerupName').value;
            const description = document.getElementById('powerupDesc').value;
            const icon = document.getElementById('powerupIcon').value || '?';
            const price = parseInt(document.getElementById('powerupPrice').value);
            const duration = parseInt(document.getElementById('powerupDuration').value);

            if (!appId) {
                alert('Please select an app');
                return;
            }

            const selectedApp = userApps.find(a => a.id == appId);

            try {
                const btn = document.getElementById('createPowerupBtn');
                btn.disabled = true;
                btn.textContent = 'Creating...';

                const response = await fetch(`${SUPABASE_URL}/rest/v1/store_powerups`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify({
                        creator_discord_id: currentUser.id,
                        app_id: appId,
                        app_name: selectedApp?.name || 'Unknown',
                        name: name,
                        description: description,
                        icon: icon,
                        price: price,
                        duration_days: duration,
                        status: 'pending', // Requires approval
                        total_sales: 0,
                        revenue_earned: 0
                    })
                });

                if (response.ok) {
                    alert('Power-up submitted for review! It will appear in the Store once approved.');
                    document.getElementById('powerupForm').reset();
                    document.getElementById('powerupIcon').value = '??';
                    await loadPowerups();
                } else {
                    throw new Error('Failed to create power-up');
                }

                btn.disabled = false;
                btn.textContent = '? Create Power-Up';
            } catch (error) {
                console.error('Error creating power-up:', error);
                alert('Error creating power-up. Please try again.');
                document.getElementById('createPowerupBtn').disabled = false;
                document.getElementById('createPowerupBtn').textContent = '? Create Power-Up';
            }
        });

        // Update loadApps to also populate power-up dropdown
        const originalLoadApps = loadApps;
        loadApps = async function () {
            await originalLoadApps();
            // Get apps for power-up select
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/apps?creator_discord_id=eq.${currentUser.id}&select=*`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY, 'Authorization': `Bearer ${SUPABASE_ANON_KEY}` }
                });
                const apps = await response.json();
                populatePowerupAppSelect(apps);
            } catch (e) { console.error('Error populating power-up select:', e); }
        };

        // Load power-ups when dashboard loads
        const originalLoadDevData = loadDevData;
        loadDevData = async function () {
            await originalLoadDevData();
            await loadPowerups();
            await loadReviewCampaigns();
        };

        // ========== REVIEW CAMPAIGN FUNCTIONS ==========

        // Update review count estimate
        function updateReviewEstimate() {
            const budget = parseInt(document.getElementById('reviewBudget').value) || 500;
            const reward = parseInt(document.getElementById('reviewReward').value) || 50;
            const estimate = Math.floor(budget / reward);
            document.getElementById('reviewCountEstimate').textContent = estimate;
        }

        document.getElementById('reviewBudget')?.addEventListener('input', updateReviewEstimate);
        document.getElementById('reviewReward')?.addEventListener('input', updateReviewEstimate);

        // Load existing review campaigns
        async function loadReviewCampaigns() {
            if (!currentUser) return;

            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/review_campaigns?developer_discord_id=eq.${currentUser.id}&select=*,suite_apps(name,icon_url)`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY, 'Authorization': `Bearer ${SUPABASE_ANON_KEY}` }
                });
                const campaigns = await response.json();

                const list = document.getElementById('reviewCampaignsList');
                if (!campaigns || campaigns.length === 0 || campaigns.error) {
                    list.innerHTML = '<div class="empty-state"><p>No review campaigns yet. Create one above to get feedback!</p></div>';
                } else {
                    list.innerHTML = campaigns.map(c => {
                        const minMins = Math.floor(c.min_usage_seconds / 60);
                        return `
                        <div class="campaign-item">
                            <div class="campaign-info">
                                <div style="font-size: 2rem; margin-right: 8px;"></div>
                                <div>
                                    <strong>${c.suite_apps?.name || 'Unknown App'}</strong>
                                    <div style="font-size: 0.85rem; color: #888;">+${c.suite_per_review} SUITE per review � ${minMins}min min</div>
                                </div>
                            </div>
                            <div class="campaign-stats">
                                <span><strong>${c.reviews_count || 0}</strong> Reviews</span>
                                <span><strong>${c.remaining_budget}</strong> Budget Left</span>
                            </div>
                            <span class="badge badge-${c.status}">${c.status}</span>
                        </div>
                    `}).join('');
                }
            } catch (error) {
                console.error('Error loading review campaigns:', error);
            }
        }

        // Create review campaign form handler
        document.getElementById('reviewCampaignForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!currentUser) {
                alert('Please log in first');
                return;
            }

            const appId = document.getElementById('reviewAppSelect').value;
            const suitePerReview = parseInt(document.getElementById('reviewReward').value);
            const minUsageSeconds = parseInt(document.getElementById('reviewMinTime').value);
            const totalBudget = parseInt(document.getElementById('reviewBudget').value);

            if (!appId) {
                alert('Please select an app');
                return;
            }

            // Check balance
            const balance = parseInt(document.getElementById('suiteBalance').textContent.replace(/,/g, '')) || 0;
            if (balance < totalBudget) {
                alert(`Insufficient SUITE balance. You have ${balance} but need ${totalBudget}.`);
                return;
            }

            const btn = document.getElementById('createReviewCampaignBtn');
            btn.disabled = true;
            btn.textContent = 'Creating...';

            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/review_campaigns`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify({
                        app_id: appId,
                        developer_discord_id: currentUser.id,
                        suite_per_review: suitePerReview,
                        min_usage_seconds: minUsageSeconds,
                        total_budget: totalBudget,
                        remaining_budget: totalBudget,
                        status: 'active'
                    })
                });

                if (response.ok) {
                    alert('Review campaign created! Users can now earn SUITE by reviewing your app.');
                    document.getElementById('reviewCampaignForm').reset();
                    document.getElementById('reviewReward').value = '50';
                    document.getElementById('reviewBudget').value = '500';
                    updateReviewEstimate();
                    await loadReviewCampaigns();
                } else {
                    const err = await response.json();
                    throw new Error(err.message || 'Failed to create campaign');
                }
            } catch (error) {
                console.error('Error creating review campaign:', error);
                alert('Error creating review campaign: ' + error.message);
            }

            btn.disabled = false;
            btn.textContent = '🌟 Start Review Campaign';
        });

        // ========== EDIT APP MODAL ==========
        function openEditAppModal(id, name, iconUrl, description, category) {
            document.getElementById('editAppId').value = id;
            document.getElementById('editAppName').value = name;
            document.getElementById('editAppIconUrl').value = iconUrl;
            document.getElementById('editAppDescription').value = description;
            document.getElementById('editAppCategory').value = category || 'productivity';

            // Show icon preview
            updateIconPreview(iconUrl);

            document.getElementById('editAppModal').style.display = 'flex';
        }

        function closeEditAppModal() {
            document.getElementById('editAppModal').style.display = 'none';
        }

        function updateIconPreview(url) {
            const preview = document.getElementById('iconPreview');
            if (url) {
                preview.innerHTML = `<img src="${url}" alt="Preview" style="width: 80px; height: 80px; border-radius: 16px; object-fit: cover;" onerror="this.outerHTML='<span style=\\'color: red; font-size: 0.9rem;\\'>⚠️ Invalid image URL</span>'">`;
            } else {
                preview.innerHTML = '';
            }
        }

        // Live preview as user types icon URL
        document.getElementById('editAppIconUrl').addEventListener('input', (e) => {
            updateIconPreview(e.target.value);
        });

        // Save app changes
        document.getElementById('editAppForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const id = document.getElementById('editAppId').value;
            const iconUrl = document.getElementById('editAppIconUrl').value;
            const description = document.getElementById('editAppDescription').value;
            const category = document.getElementById('editAppCategory').value;

            try {
                // Try updating suite_apps first
                let response = await fetch(`${SUPABASE_URL}/rest/v1/suite_apps?id=eq.${id}`, {
                    method: 'PATCH',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify({
                        icon_url: iconUrl || null,
                        description: description,
                        category: category
                    })
                });

                // Also try updating the apps table (for apps there)
                await fetch(`${SUPABASE_URL}/rest/v1/apps?id=eq.${id}`, {
                    method: 'PATCH',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify({
                        icon_url: iconUrl || null,
                        description: description,
                        category: category
                    })
                });

                alert('✅ App updated successfully!');
                closeEditAppModal();
                loadApps(); // Reload apps list
            } catch (error) {
                console.error('Error updating app:', error);
                alert('Error updating app: ' + error.message);
            }
        });

        // Close modal when clicking outside
        document.getElementById('editAppModal').addEventListener('click', (e) => {
            if (e.target.id === 'editAppModal') {
                closeEditAppModal();
            }
        });

        // ═══ PC PROMPT SERVER FUNCTIONS (Owner Only) ═══
        const PC_SERVER_URL = 'http://10.0.0.142:3000';  // Stuart's PC
        const OWNER_DISCORD_ID = '1135315153824993402';  // Stuart's Discord ID

        // Show prompt server section only for owner
        function checkOwnerAccess() {
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            const savedUser = localStorage.getItem('suiteDev');
            let isOwner = false;

            if (savedUser) {
                const user = JSON.parse(savedUser);
                isOwner = user.id === OWNER_DISCORD_ID;
            }

            // Show on localhost (for testing) OR if logged in as Stuart
            if (isLocalhost || isOwner) {
                document.getElementById('section-prompt-server').style.display = 'block';
                checkPcStatus();
                setInterval(checkPcStatus, 10000); // Check every 10 sec
            }
        }

        async function checkPcStatus() {
            try {
                const res = await fetch(`${PC_SERVER_URL}/status`);
                const data = await res.json();
                document.getElementById('pcStatus').textContent = '🟢 Connected';
                document.getElementById('pcStatus').style.color = '#22c55e';
                document.getElementById('pendingPrompts').textContent = data.pending_prompts || 0;

                // Update auto-pull status
                if (data.auto_pull) {
                    document.getElementById('autoPullStatus').textContent = 'ON';
                    document.getElementById('autoPullStatus').style.color = '#22c55e';
                    document.getElementById('autoPullBtn').innerHTML = '▶️ Auto-Pull: ON';
                    document.getElementById('autoPullBtn').style.background = 'linear-gradient(135deg, #22c55e, #16a34a)';
                    document.getElementById('autoPullBtn').style.color = 'white';
                } else {
                    document.getElementById('autoPullStatus').textContent = 'OFF';
                    document.getElementById('autoPullStatus').style.color = '#6b7280';
                    document.getElementById('autoPullBtn').innerHTML = '⏸️ Auto-Pull: OFF';
                    document.getElementById('autoPullBtn').style.background = '#f3f4f6';
                    document.getElementById('autoPullBtn').style.color = '#5a4a6f';
                }
            } catch (err) {
                document.getElementById('pcStatus').textContent = '🔴 Offline';
                document.getElementById('pcStatus').style.color = '#ef4444';
            }
        }

        async function sendPcPrompt() {
            const prompt = document.getElementById('pcPrompt').value.trim();
            const responseEl = document.getElementById('pcResponse');

            if (!prompt) {
                responseEl.style.display = 'block';
                responseEl.style.background = 'rgba(239, 68, 68, 0.1)';
                responseEl.style.color = '#ef4444';
                responseEl.textContent = '❌ Please enter a prompt';
                return;
            }

            try {
                const res = await fetch(`${PC_SERVER_URL}/send`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt })
                });
                const data = await res.json();

                responseEl.style.display = 'block';
                if (data.success) {
                    responseEl.style.background = 'rgba(34, 197, 94, 0.1)';
                    responseEl.style.color = '#22c55e';
                    responseEl.textContent = '✅ Sent to PC! Watcher will process it.';
                    document.getElementById('pcPrompt').value = '';
                    checkPcStatus();
                } else {
                    responseEl.style.background = 'rgba(239, 68, 68, 0.1)';
                    responseEl.style.color = '#ef4444';
                    responseEl.textContent = '❌ ' + (data.error || 'Failed to send');
                }
            } catch (err) {
                responseEl.style.display = 'block';
                responseEl.style.background = 'rgba(239, 68, 68, 0.1)';
                responseEl.style.color = '#ef4444';
                responseEl.textContent = '❌ PC offline or not reachable';
            }
        }

        async function gitPullNow() {
            const responseEl = document.getElementById('pcResponse');
            try {
                const res = await fetch(`${PC_SERVER_URL}/pull`, { method: 'POST' });
                const data = await res.json();

                responseEl.style.display = 'block';
                if (data.success) {
                    responseEl.style.background = 'rgba(34, 197, 94, 0.1)';
                    responseEl.style.color = '#22c55e';
                    responseEl.textContent = '📥 ' + (data.output || 'Already up to date');
                } else {
                    responseEl.style.background = 'rgba(239, 68, 68, 0.1)';
                    responseEl.style.color = '#ef4444';
                    responseEl.textContent = '❌ Pull failed: ' + data.error;
                }
            } catch (err) {
                responseEl.style.display = 'block';
                responseEl.style.background = 'rgba(239, 68, 68, 0.1)';
                responseEl.style.color = '#ef4444';
                responseEl.textContent = '❌ Could not reach PC';
            }
        }

        async function toggleAutoPull() {
            try {
                const res = await fetch(`${PC_SERVER_URL}/auto-pull`, { method: 'POST' });
                const data = await res.json();
                checkPcStatus(); // Refresh status
            } catch (err) {
                console.error('Failed to toggle auto-pull:', err);
            }
        }

        function sendQuickPrompt(prompt) {
            document.getElementById('pcPrompt').value = prompt;
            sendPcPrompt();
        }

        // ═══ CONTENT STUDIO FUNCTIONS ═══
        const OWNER_USER_ID = OWNER_DISCORD_ID;
        let isOwnerUser = false;

        // Check if user is owner for free access
        function checkContentStudioOwner() {
            const savedUser = localStorage.getItem('suiteDev');
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

            if (savedUser) {
                const user = JSON.parse(savedUser);
                isOwnerUser = user.id === OWNER_USER_ID;
            }

            if (isLocalhost || isOwnerUser) {
                // Show owner badge and set free pricing
                document.getElementById('studioOwnerBadge').style.display = 'flex';
                document.getElementById('videoPricingBadge').innerHTML = '<span style="text-decoration: line-through; opacity: 0.6;">100 SUITE</span> FREE';
                document.getElementById('batchPrice').innerHTML = '<span style="text-decoration: line-through;">50</span> FREE';
                document.getElementById('priorityPrice').innerHTML = '<span style="text-decoration: line-through;">100</span> FREE';
                document.getElementById('voiceStandardPrice').innerHTML = '<span style="text-decoration: line-through;">50</span> FREE';
                document.getElementById('voiceClonePrice').innerHTML = '<span style="text-decoration: line-through;">200</span> FREE';
            }
        }

        // Template selection handling
        document.querySelectorAll('input[name="videoTemplate"]').forEach(radio => {
            radio.addEventListener('change', function () {
                // Update visual selection
                document.querySelectorAll('.template-option').forEach(opt => {
                    opt.style.background = '#f8f9fa';
                    opt.style.borderColor = 'transparent';
                });
                this.nextElementSibling.style.background = 'rgba(255, 149, 0, 0.1)';
                this.nextElementSibling.style.borderColor = '#ff9500';

                // Show/hide custom prompt
                const customSection = document.getElementById('customPromptSection');
                customSection.style.display = this.value === 'custom' ? 'block' : 'none';
            });
        });

        // Priority selection handling for video
        document.querySelectorAll('input[name="videoPriority"]').forEach(radio => {
            radio.addEventListener('change', function () {
                document.querySelectorAll('input[name="videoPriority"]').forEach(r => {
                    const div = r.nextElementSibling;
                    if (r.checked) {
                        div.style.background = 'rgba(255, 149, 0, 0.1)';
                        div.style.borderColor = '#ff9500';
                    } else {
                        div.style.background = '#f8f9fa';
                        div.style.borderColor = 'transparent';
                    }
                });
            });
        });

        // Voice selection handling
        document.querySelectorAll('input[name="voiceSelect"]').forEach(radio => {
            radio.addEventListener('change', function () {
                document.querySelectorAll('.voice-option').forEach(opt => {
                    opt.style.background = '#f8f9fa';
                    opt.style.borderColor = 'transparent';
                });
                this.nextElementSibling.style.background = 'rgba(99, 102, 241, 0.1)';
                this.nextElementSibling.style.borderColor = '#6366f1';
            });
        });

        // Voice script character counter
        document.getElementById('voiceScript')?.addEventListener('input', function () {
            const count = this.value.length;
            document.getElementById('voiceCharCount').textContent = `${count} / 500 chars`;
        });

        // Generate video function
        function generateVideo() {
            const template = document.querySelector('input[name="videoTemplate"]:checked').value;
            const priority = document.querySelector('input[name="videoPriority"]:checked').value;
            const app = document.getElementById('videoAppSelect').value;
            const customPrompt = document.getElementById('customVideoPrompt')?.value || '';

            const cost = isOwnerUser ? 0 : (priority === 'batch' ? 50 : 100);

            if (cost > 0) {
                const confirm = window.confirm(`This will cost ${cost} SUITE. Proceed?`);
                if (!confirm) return;
            }

            // For now, show confirmation
            alert(`🎬 Video generation request submitted!\n\nTemplate: ${template}\nPriority: ${priority}\nCost: ${cost === 0 ? 'FREE (Owner)' : cost + ' SUITE'}\n\nYou'll receive your clips within ${priority === 'batch' ? '24 hours' : '1-2 hours'}.`);
        }

        // Generate voice function
        function generateVoice() {
            const voice = document.querySelector('input[name="voiceSelect"]:checked').value;
            const priority = document.querySelector('input[name="voicePriority"]:checked').value;
            const script = document.getElementById('voiceScript').value;

            if (!script.trim()) {
                alert('Please enter a script to generate voiceover.');
                return;
            }

            const cost = isOwnerUser ? 0 : (priority === 'clone' ? 200 : 50);

            if (cost > 0) {
                const confirm = window.confirm(`This will cost ${cost} SUITE. Proceed?`);
                if (!confirm) return;
            }

            alert(`🎙️ Voiceover generation submitted!\n\nVoice: ${voice}\nType: ${priority === 'clone' ? 'Voice Clone' : 'Standard'}\nCost: ${cost === 0 ? 'FREE (Owner)' : cost + ' SUITE'}\n\nYour audio will be ready shortly.`);
        }

        // ═══ CONTENT MARKETPLACE FUNCTIONS ═══
        async function loadMarketplaceBounties() {
            try {
                const { data: bounties, error } = await supabase
                    .from('content_bounties')
                    .select('*')
                    .eq('status', 'open')
                    .order('reward_amount', { ascending: false })
                    .limit(3);

                if (error) throw error;

                // Update stats
                const openCount = bounties?.length || 0;
                document.getElementById('dashboardOpenBounties').textContent = openCount;

                // Get total paid
                const { data: completed } = await supabase
                    .from('content_bounties')
                    .select('reward_amount')
                    .eq('status', 'completed');

                const totalPaid = (completed || []).reduce((sum, b) => sum + b.reward_amount, 0);
                document.getElementById('dashboardTotalPaid').textContent = totalPaid > 0 ? totalPaid.toLocaleString() : '0';

                // Render featured bounties
                const container = document.getElementById('featuredBounties');
                if (bounties && bounties.length > 0) {
                    container.innerHTML = bounties.map(b => `
                            <div onclick="window.location='content.html'" style="background: white; border-radius: 16px; padding: 20px; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="background: rgba(255, 149, 0, 0.1); color: #ff9500; padding: 4px 10px; border-radius: 100px; font-size: 0.75rem; font-weight: 700;">
                                        ${b.content_type === 'video' ? '🎬' : b.content_type === 'graphic' ? '🎨' : '✍️'} ${b.content_type}
                                    </span>
                                    <span style="font-weight: 800; color: #ff9500;">${b.reward_amount} SUITE</span>
                                </div>
                                <div style="font-weight: 700; color: #2d1b4e; margin-bottom: 4px;">${escapeHtml(b.title)}</div>
                                <div style="color: #6b7280; font-size: 0.85rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">${escapeHtml(b.description || '')}</div>
                            </div>
                        `).join('');
                } else {
                    container.innerHTML = '<div style="background: white; border-radius: 16px; padding: 24px; text-align: center; color: #888; grid-column: 1/-1;">No open bounties right now. Post the first one!</div>';
                }
            } catch (err) {
                console.error('Error loading marketplace:', err);
                document.getElementById('featuredBounties').innerHTML = '<div style="background: white; border-radius: 16px; padding: 24px; text-align: center; color: #888;">Unable to load bounties</div>';
            }
        }

        function escapeHtml(str) {
            if (!str) return '';
            return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        }

        function openBountyModal() {
            window.location = 'content.html';
        }

        // Initialize Content Studio and Marketplace
        setTimeout(() => {
            checkContentStudioOwner();
            loadMarketplaceBounties();
        }, 500);

        // ═══ SIDEBAR NAVIGATION ═══
        function showSection(sectionId) {
            // Hide all panels
            document.querySelectorAll('.section-panel').forEach(panel => {
                panel.classList.remove('active');
            });

            // Show selected panel
            const panel = document.getElementById('panel-' + sectionId);
            if (panel) {
                panel.classList.add('active');
            }

            // Update sidebar active state
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');
            });

            // Find and activate clicked link
            document.querySelectorAll('.sidebar-link').forEach(link => {
                if (link.textContent.toLowerCase().includes(sectionId) ||
                    (sectionId === 'overview' && link.textContent.includes('Overview')) ||
                    (sectionId === 'apps' && link.textContent.includes('Your Apps')) ||
                    (sectionId === 'studio' && link.textContent.includes('Content Studio')) ||
                    (sectionId === 'prompt-server' && link.textContent.includes('PC Prompt'))) {
                    link.classList.add('active');
                }
            });

            // Save to localStorage
            localStorage.setItem('dashboardSection', sectionId);

            // Update URL hash
            history.replaceState(null, '', '#' + sectionId);
        }

        // Update sidebar user info when logged in
        function updateSidebarUser(user) {
            if (user) {
                document.getElementById('sidebarUser').style.display = 'flex';
                document.getElementById('sidebarLoginPrompt').style.display = 'none';
                document.getElementById('sidebarAvatar').src = user.avatar || 'assets/suite-mascot.png';
                document.getElementById('sidebarUserName').textContent = user.username || 'Developer';

                // Show admin section for owner
                const isOwner = user.id === OWNER_DISCORD_ID;
                const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
                if (isOwner || isLocalhost) {
                    document.getElementById('adminSection').style.display = 'block';
                }
            } else {
                document.getElementById('sidebarUser').style.display = 'none';
                document.getElementById('sidebarLoginPrompt').style.display = 'block';
            }
        }

        // Restore last section or check URL hash
        function initSidebarNavigation() {
            const hash = window.location.hash.slice(1);
            const savedSection = localStorage.getItem('dashboardSection');

            if (hash && document.getElementById('panel-' + hash)) {
                showSection(hash);
            } else if (savedSection && document.getElementById('panel-' + savedSection)) {
                showSection(savedSection);
            }

            // Check if user is logged in and update sidebar
            const savedUser = localStorage.getItem('suiteDev');
            if (savedUser) {
                const user = JSON.parse(savedUser);
                updateSidebarUser(user);
            }
        }

        // Initialize navigation on load
        setTimeout(initSidebarNavigation, 200);

        // Check owner access on load
        setTimeout(checkOwnerAccess, 1000);

        // ═══ AI FLEET FUNCTIONS ═══
        async function saveAIConfig() {
            const config = {
                iterations_per_app: document.getElementById('configIterations').value,
                max_apps_per_day: document.getElementById('configMaxApps').value,
                auto_deploy: document.getElementById('configAutoDeploy').checked.toString(),
                telos_enabled: document.getElementById('configTelosEnabled').checked.toString()
            };

            try {
                // Save each config value
                for (const [key, value] of Object.entries(config)) {
                    await fetch(`${SUPABASE_URL}/rest/v1/ai_config?key=eq.${key}`, {
                        method: 'PATCH',
                        headers: {
                            'apikey': SUPABASE_ANON_KEY,
                            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                            'Content-Type': 'application/json',
                            'Prefer': 'return=minimal'
                        },
                        body: JSON.stringify({ value: value, updated_at: new Date().toISOString() })
                    });
                }
                alert('✅ AI Fleet configuration saved!');
            } catch (error) {
                console.error('Error saving AI config:', error);
                alert('❌ Failed to save configuration');
            }
        }


        async function loadAIFleetStats() {
            try {
                // Get AI apps count
                const aiAppsResponse = await fetch(`${SUPABASE_URL}/rest/v1/suite_apps?origin=eq.ai&select=id`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY }
                });
                const aiApps = await aiAppsResponse.json();
                document.getElementById('aiFleetTotalApps').textContent = Array.isArray(aiApps) ? aiApps.length : 0;

                // Get today's apps (created today with origin=ai)
                const today = new Date().toISOString().split('T')[0];
                const todayAppsResponse = await fetch(`${SUPABASE_URL}/rest/v1/suite_apps?origin=eq.ai&created_at=gte.${today}&select=id`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY }
                });
                const todayApps = await todayAppsResponse.json();
                document.getElementById('aiFleetToday').textContent = Array.isArray(todayApps) ? todayApps.length : 0;

                // Load config values
                const configResponse = await fetch(`${SUPABASE_URL}/rest/v1/ai_config?select=key,value`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY }
                });
                const configs = await configResponse.json();

                if (Array.isArray(configs)) {
                    configs.forEach(c => {
                        if (c.key === 'iterations_per_app') document.getElementById('configIterations').value = c.value;
                        if (c.key === 'max_apps_per_day') document.getElementById('configMaxApps').value = c.value;
                        if (c.key === 'auto_deploy') document.getElementById('configAutoDeploy').checked = c.value === 'true';
                        if (c.key === 'telos_enabled') {
                            const isEnabled = c.value === 'true';
                            document.getElementById('configTelosEnabled').checked = isEnabled;
                            document.getElementById('telosMainToggle').checked = isEnabled;
                            updateTelosUI(isEnabled);
                        }
                    });
                }

                // Check for pending human requests
                await checkHumanPriority();

                // Load activity feed
                await loadActivityFeed();

            } catch (error) {
                console.error('Error loading AI Fleet stats:', error);
            }
        }

        // Toggle TELOS mode from the hero toggle
        async function toggleTelosMode() {
            const toggle = document.getElementById('telosMainToggle');
            const isEnabled = toggle.checked;

            // Sync with config checkbox
            document.getElementById('configTelosEnabled').checked = isEnabled;

            // Update UI
            updateTelosUI(isEnabled);

            // Save to Supabase
            try {
                await fetch(`${SUPABASE_URL}/rest/v1/ai_config?key=eq.telos_enabled`, {
                    method: 'PATCH',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify({ value: isEnabled ? 'true' : 'false', updated_at: new Date().toISOString() })
                });
            } catch (error) {
                console.error('Error saving TELOS state:', error);
            }
        }

        // Update TELOS UI based on state
        function updateTelosUI(isEnabled) {
            const slider = document.getElementById('telosSlider');
            const knob = document.getElementById('telosKnob');
            const onLabel = document.getElementById('telosOnLabel');
            const offLabel = document.getElementById('telosOffLabel');
            const explanation = document.getElementById('telosExplanation');
            const statusText = document.getElementById('telosStatusText');

            if (isEnabled) {
                slider.style.background = 'linear-gradient(135deg, #22c55e, #16a34a)';
                slider.style.boxShadow = '0 4px 12px rgba(34, 197, 94, 0.3)';
                knob.style.left = '44px';
                onLabel.style.color = '#22c55e';
                onLabel.style.fontWeight = '700';
                offLabel.style.color = '#888';
                offLabel.style.fontWeight = '600';
                explanation.style.background = 'rgba(34, 197, 94, 0.1)';
                explanation.style.borderLeftColor = '#22c55e';
                explanation.innerHTML = '<p style="margin: 0; font-size: 0.9rem; color: #16a34a; font-weight: 600;">✅ ACTIVE: AI is researching markets, building apps, and deploying automatically.</p>';
                statusText.textContent = 'AI creates apps autonomously 24/7';
            } else {
                slider.style.background = '#ccc';
                slider.style.boxShadow = 'none';
                knob.style.left = '4px';
                onLabel.style.color = '#888';
                onLabel.style.fontWeight = '600';
                offLabel.style.color = '#6b7280';
                offLabel.style.fontWeight = '700';
                explanation.style.background = 'rgba(107, 114, 128, 0.1)';
                explanation.style.borderLeftColor = '#6b7280';
                explanation.innerHTML = '<p style="margin: 0; font-size: 0.9rem; color: #6b7280; font-weight: 600;">⏸️ PAUSED: AI only responds to human requests (bugs, features)</p>';
                statusText.textContent = 'AI responds to human requests only';
            }
        }

        // Check if there are pending human requests
        async function checkHumanPriority() {
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/prompts?status=eq.pending&select=id`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY }
                });
                const pending = await response.json();
                const banner = document.getElementById('humanPriorityBanner');
                const countEl = document.getElementById('humanRequestCount');

                if (Array.isArray(pending) && pending.length > 0) {
                    banner.style.display = 'flex';
                    countEl.textContent = pending.length === 1 ? '1 in queue' : `${pending.length} in queue`;
                } else {
                    banner.style.display = 'none';
                }
            } catch (error) {
                console.error('Error checking human priority:', error);
            }
        }

        // Load activity feed from ai_activity_log
        async function loadActivityFeed() {
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/ai_activity_log?order=timestamp.desc&limit=20`, {
                    headers: { 'apikey': SUPABASE_ANON_KEY }
                });
                const logs = await response.json();
                const feedContainer = document.getElementById('aiActivityFeed');

                if (Array.isArray(logs) && logs.length > 0) {
                    feedContainer.innerHTML = logs.map(log => {
                        const time = new Date(log.timestamp).toLocaleTimeString('en-US', { hour12: false });
                        let color = '#888';
                        let emoji = '📝';

                        switch (log.action_type) {
                            case 'research': color = '#fbbf24'; emoji = '🔍'; break;
                            case 'iteration': color = '#60a5fa'; emoji = '🔄'; break;
                            case 'deploy': color = '#4ade80'; emoji = '✅'; break;
                            case 'error': color = '#f87171'; emoji = '❌'; break;
                            case 'start_build': color = '#a78bfa'; emoji = '💡'; break;
                            case 'telos_on': color = '#22c55e'; emoji = '▶️'; break;
                            case 'telos_off': color = '#6b7280'; emoji = '⏸️'; break;
                        }

                        return `<div style="color: ${color};">${time} ${emoji} ${log.message}</div>`;
                    }).join('');
                } else {
                    feedContainer.innerHTML = '<div style="color: #888;">— No activity yet. Enable TELOS to start! —</div>';
                }
            } catch (error) {
                console.error('Error loading activity feed:', error);
                // Keep existing mock data if fetch fails
            }
        }

        // Load AI Fleet stats when the panel is shown
        document.addEventListener('DOMContentLoaded', () => {
            // Check if AI Fleet panel exists
            if (document.getElementById('panel-ai-fleet')) {
                loadAIFleetStats();
                setupAIFleetPermissions();

                // Refresh every 30 seconds
                setInterval(() => {
                    loadAIFleetStats();
                }, 30000);
            }
        });

        // Setup owner-only permissions for AI Fleet controls
        function setupAIFleetPermissions() {
            const isOwner = checkIfOwner();
            const toggleControls = document.getElementById('telosToggleControls');
            const statusBadge = document.getElementById('telosStatusBadge');
            const configPanel = document.getElementById('aiFleetConfigPanel');

            if (isOwner) {
                // Owner: show toggle controls, hide status badge
                if (toggleControls) toggleControls.style.display = 'flex';
                if (statusBadge) statusBadge.style.display = 'none';
                if (configPanel) configPanel.style.display = 'block';
            } else {
                // Non-owner: hide toggle controls, show status badge, hide config
                if (toggleControls) toggleControls.style.display = 'none';
                if (statusBadge) statusBadge.style.display = 'block';
                if (configPanel) configPanel.style.display = 'none';
            }
        }

        // Check if current user is the owner
        function checkIfOwner() {
            // Check if logged in as owner via localStorage
            const savedUser = localStorage.getItem('suite_user');
            if (savedUser) {
                try {
                    const user = JSON.parse(savedUser);
                    // Replace with your actual Discord ID
                    const OWNER_ID = '287364619419049984';
                    if (user.id === OWNER_ID) return true;
                } catch (e) { }
            }

            // Also allow on localhost for testing
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                return true;
            }

            return false;
        }



    </script>

    < !--Stu Helper Widget-->
        <link rel="stylesheet" href="stu-helper.css">
        <script src="stu-helper.js"></script>
</body>

</html>